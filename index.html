<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naver Webtoon AI Picker</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { primary: '#8D6E63', bgLight: '#F5F7FA' },
                    boxShadow: { 'soft': '0 10px 40px rgba(0,0,0,0.05)', 'blue': '0 15px 45px rgba(141,110,99,0.2)' }
                }
            }
        }
    </script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #F5F7FA;
            background-image: linear-gradient(rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.7)), url('bg.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            -webkit-font-smoothing: antialiased;
            margin: 0;
            padding: 0;
        }

        #root {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid #F1F5F9;
        }

        main {
            transform: scale(0.85);
            transform-origin: top center;
            margin-top: 100px;
            flex: 1;
            width: 100%;
        }

        .modal-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 150000;
            display: flex;
            justify-content: center;
            align-items: start;
            padding-top: 12vh;
            /* ì¡°ê¸ˆ ë” ì•„ë˜ë¡œ ë‚´ë¦¼ */
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            overflow-y: auto;
        }

        .modal-content-box {
            transform: scale(1.1);
            transform-origin: top center;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .animate-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .backdrop-blur-custom {
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
        }

        .modal-open {
            overflow: hidden !important;
        }

        .premium-gray-btn {
            background: #F8FAFC;
            border: 1px solid #F1F5F9;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .premium-gray-btn:hover {
            background: #F1F5F9;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        @keyframes blink {
            0% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.8;
                transform: scale(1.03);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-blink {
            animation: blink 2s infinite ease-in-out;
        }
    </style>
    <!-- Kakao SDK -->
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js"></script>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <div id="root"></div>

    <!-- React/Babel CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="data.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Supabase Config ---
        const SUPABASE_URL = 'https://vxzdgyentxxipjervdzq.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ4emRneWVudHh4aXBqZXJ2ZHpxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg4MjQ0ODEsImV4cCI6MjA4NDQwMDQ4MX0.HyZIWay1RI7JHVdVYpkWBTtjg9goQH4muUEaqqG6fPU';
        const supabaseInstance = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        const supabaseClient = supabaseInstance;

        // --- Kakao Key Management ---
        const KAKAO_JS_KEY = '7716eb056c6c408381180fb2987a0279';

        const initKakao = () => {
            if (window.Kakao && !Kakao.isInitialized()) {
                try { Kakao.init(KAKAO_JS_KEY); } catch (e) { console.error("Kakao Init Failed:", e); }
            }
        };

        const TRANSLATIONS = {
            ko: {
                subtitle: "ë‚˜ì˜ ì·¨í–¥ì— ë§ëŠ” ë„¤ì´ë²„ì›¹íˆ° ì°¾ê¸°(With AI)",
                process: "ë¶„ì„ í”„ë¡œì„¸ìŠ¤",
                step: "ë‹¨ê³„",
                of: "/",
                share: "ê³µìœ í•˜ê¸°",
                step1_title: "ì„ í˜¸ì·¨í–¥ì„ ê³¨ë¼ì£¼ì„¸ìš”.",
                step1_desc: "ë‹¤ì–‘í•œ ì¥ë¥´ ì¤‘ 1ê°œ ì´ìƒ ì„ íƒì´ í•„ìˆ˜ì…ë‹ˆë‹¤.",
                cat_status: "ì—°ì¬ ìƒíƒœ",
                cat_genre: "ë©”ì¸ ì¥ë¥´",
                cat_topic: "ì¸ê¸° ì†Œì¬",
                cat_feature: "ìŠ¤í† ë¦¬ íŠ¹ì§•",
                next: "ë‹¤ìŒ ë‹¨ê³„",
                step2_title: "ë¹„ì„ í˜¸ ì·¨í–¥ì„ ê³¨ë¼ì£¼ì„¸ìš” (ì„ íƒ)",
                step2_desc: "ì„ íƒí•œ ì·¨í–¥ì´ í¬í•¨ëœ ì›¹íˆ°ì€ ì¶”ì²œì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.",
                back: "ì´ì „",
                continue: "ê³„ì†í•˜ê¸°",
                step3_title: "ê°€ì¥ ì¬ë¯¸ìˆê²Œ ë³´ì‹ \nì›¹íˆ°ì€ ë¬´ì—‡ì¸ê°€ìš”?",
                step3_placeholder: "ì›¹íˆ° ì œëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”",
                start_analysis: "ë¶„ì„ ì‹œì‘",
                computing: "ê²°ê³¼ ê³„ì‚° ì¤‘...",
                result_title: "AI ì¶”ì²œ ê²°ê³¼",
                result_desc: "ì‚¬ìš©ìì˜ ê³ ìœ  ì·¨í–¥ì„ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤.",
                exclude: "ì¶”ì²œì œì™¸",
                view_now: "ë³´ëŸ¬ê°€ê¸°",
                new_analysis: "ìƒˆë¡œìš´ ë¶„ì„",
                exclude_msg: "ì•ìœ¼ë¡œ ì´ ì›¹íˆ°ì€ ì¶”ì²œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                like: "ì¢‹ì•„ìš”",
                dislike: "ì‹«ì–´ìš”",
                share_copy: "ë¶„ì„ ê²°ê³¼ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!",
                share_fail: "ë³µì‚¬ ì‹¤íŒ¨",
                share_tpl_title: "[AIR.NW] AI ì¶”ì²œ ê²°ê³¼",
                share_tpl_link: "ë‚˜ë„ í•´ë³´ê¸°",
                share_modal_title: "ê³µìœ í•˜ê¸°",
                share_to_kakao: "ì¹´ì¹´ì˜¤í†¡",
                share_to_line: "ë¼ì¸",
                share_to_tiktok: "í‹±í†¡",
                share_to_text: "ê²°ê³¼ ë³µì‚¬",
                share_to_system: "ê¸°íƒ€ ê³µìœ ",
                conflict_msg: "ë‹¨ê³„ 1ì—ì„œ ì„ íƒí•œ ì„ í˜¸ íƒœê·¸ì…ë‹ˆë‹¤.\në¹„ì„ í˜¸ë¡œ ë°”ê¾¸ì‹œê² ìŠµë‹ˆê¹Œ?",
                yes: "ì˜ˆ",
                no: "ì•„ë‹ˆì˜¤",
                main: "ë©”ì¸",
                ongoing: "ì—°ì¬ì¤‘",
                finished: "ì™„ê²°",
                login: "ë¡œê·¸ì¸",
                logout: "ë¡œê·¸ì•„ì›ƒ",
                email: "ì´ë©”ì¼",
                password: "ë¹„ë°€ë²ˆí˜¸",
                login_btn: "ë¡œê·¸ì¸",
                signup_btn: "íšŒì›ê°€ì…",
                social_login: "ì†Œì…œ ë¡œê·¸ì¸",
                auth_title: "ë¡œê·¸ì¸ / íšŒì›ê°€ì…",
                like: "ì¢‹ì•„ìš”",
                my_info: "ë‚´ ì •ë³´",
                liked_list: "ì„ í˜¸ ì‘í’ˆ (ì¢‹ì•„ìš”)",
                excluded_list: "ë¹„ì„ í˜¸ ì‘í’ˆ (ì‹«ì–´ìš”)",
                delete_account: "íšŒì› íƒˆí‡´",
                find_pw: "ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°",
                reset_pw_msg: "ì´ë©”ì¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë§í¬ê°€ ë°œê¸‰ë©ë‹ˆë‹¤.",
                delete_confirm: "ì •ë§ë¡œ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì €ì¥ëœ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.",
                no_data: "ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",
                password_confirm: "ë¹„ë°€ë²ˆí˜¸ ì¬í™•ì¸",
                pw_mismatch: "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                pw_criteria: "ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.",
                email_invalid: "ìœ íš¨í•œ ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.",
                go_to_signup: "ì•„ì§ ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? íšŒì›ê°€ì…",
                go_to_login: "ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? ë¡œê·¸ì¸",
                signup_confirm_msg: "ê°€ì… í™•ì¸ ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤! ë©”ì¼í•¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",
                login_error_msg: "ë¡œê·¸ì¸ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                signup_success: "íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!",
                worldcup: "ì›¹íˆ° ì›”ë“œì»µ",
                worldcup_title: "ì›¹íˆ° ì´ìƒí˜• ì›”ë“œì»µ",
                worldcup_select_round: "ë¼ìš´ë“œ ì„ íƒ",
                worldcup_start: "ì‹œì‘í•˜ê¸°",
                worldcup_vs: "VS",
                worldcup_round: "ê°•",
                worldcup_final: "ê²°ìŠ¹",
                worldcup_winner: "ìš°ìŠ¹",
                worldcup_result: "ì›”ë“œì»µ ê²°ê³¼",
                worldcup_history: "ì›”ë“œì»µ ê¸°ë¡",
                exclude_from_reco: "ì¶”ì²œ ì œì™¸",
                exclude_from_reco_desc: "ì„ í˜¸ë„ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ë§Œ ì¶”ì²œ ê²°ê³¼ì—ì„œëŠ” ì œì™¸ë©ë‹ˆë‹¤",
                today_visitors: "ì˜¤ëŠ˜ ë°©ë¬¸ì",
                total_visitors: "ì´ ë°©ë¬¸ì"
            },
            en: {
                subtitle: "Find Naver Webtoons That Match Your Taste(With AI)",
                process: "Analysis Process",
                step: "Step",
                of: "of",
                share: "Share",
                step1_title: "Choose Preferred Tastes",
                step1_desc: "Please select at least one genre.",
                cat_status: "Status",
                cat_genre: "Main Genre",
                cat_topic: "Popular Topics",
                cat_feature: "Story Features",
                next: "Next Step",
                step2_title: "Choose Non-preferred Tastes (Optional)",
                step2_desc: "Webtoons with these tags will be strictly excluded.",
                back: "Back",
                continue: "Continue",
                step3_title: "What is your\nfavorite webtoon?",
                step3_placeholder: "Enter the webtoon title",
                start_analysis: "Start Analysis",
                computing: "Computing Result...",
                result_title: "AI Best Recommendations",
                result_desc: "Analyzed based on your unique preferences.",
                exclude: "Exclude",
                view_now: "View Now",
                new_analysis: "New Analysis",
                exclude_msg: "This webtoon will no longer be recommended.",
                like: "Like",
                dislike: "Dislike",
                share_copy: "Results copied to clipboard!",
                share_fail: "Copy failed.",
                share_tpl_title: "[AIR.NW] AI Recommended Results",
                share_tpl_link: "Try it yourself",
                share_modal_title: "Share Results",
                share_to_kakao: "KakaoTalk",
                share_to_line: "LINE",
                share_to_tiktok: "TikTok",
                share_to_text: "Copy Results",
                share_to_system: "Others",
                conflict_msg: "This is a preferred tag from Step 1.\nChange it to non-preferred?",
                yes: "Yes",
                no: "No",
                main: "Main",
                ongoing: "Ongoing",
                finished: "Finished",
                login: "Login",
                logout: "Logout",
                email: "Email",
                password: "Password",
                login_btn: "Login",
                signup_btn: "Sign Up",
                auth_title: "Login / Sign Up",
                like: "Like",
                my_info: "My Info",
                liked_list: "Preferred (Like)",
                excluded_list: "Disliked",
                delete_account: "Delete Account",
                find_pw: "Forgot Password?",
                reset_pw_msg: "A password reset link has been sent to your email.",
                delete_confirm: "Are you sure you want to delete your account?\nAll saved data will be permanently removed.",
                no_data: "No data found.",
                password_confirm: "Confirm Password",
                pw_mismatch: "Passwords do not match.",
                pw_criteria: "Password must be at least 6 characters.",
                email_invalid: "Please enter a valid email.",
                go_to_signup: "Don't have an account? Sign Up",
                go_to_login: "Already have an account? Login",
                signup_confirm_msg: "Confirmation email sent! Please check your inbox.",
                login_error_msg: "Invalid login credentials.",
                signup_success: "Sign-up completed successfully!",
                worldcup: "Webtoon Worldcup",
                worldcup_title: "Webtoon Ideal Type Worldcup",
                worldcup_select_round: "Select Round",
                worldcup_start: "Start",
                worldcup_vs: "VS",
                worldcup_round: "Round",
                worldcup_final: "Final",
                worldcup_winner: "Winner",
                worldcup_result: "Worldcup Result",
                worldcup_history: "Worldcup History",
                exclude_from_reco: "Exclude from Recommendations",
                exclude_from_reco_desc: "Affects preference but excluded from recommendation results",
                today_visitors: "Today",
                total_visitors: "Total"
            },
            zh: {
                subtitle: "My Pick Naver WebToon(with AI)",
                process: "åˆ†æè¿›åº¦",
                step: "ç¬¬",
                of: "æ­¥ / å…±",
                share: "åˆ†äº«",
                step1_title: "è¯·é€‰æ‹©æ‚¨å–œå¥½çš„å£å‘³",
                step1_desc: "è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªç±»åˆ«ã€‚",
                cat_status: "è¿è½½çŠ¶æ€",
                cat_genre: "ä¸»æ‰“ç±»å‹",
                cat_topic: "çƒ­é—¨ç´ æ",
                cat_feature: "å‰§æƒ…ç‰¹ç‚¹",
                next: "ä¸‹ä¸€æ­¥",
                step2_title: "è¯·é€‰æ‹©ä¸å–œæ¬¢çš„å£å‘³ (å¯é€‰)",
                step2_desc: "åŒ…å«æ‰€é€‰æ ‡ç­¾çš„æ¼«ç”»å°†ä»æ¨èä¸­æ’é™¤ã€‚",
                back: "è¿”å›",
                continue: "ç»§ç»­",
                step3_title: "æ‚¨æœ€å–œæ¬¢çš„\næ¼«ç”»æ˜¯ä»€ä¹ˆï¼Ÿ",
                step3_placeholder: "è¯·è¾“å…¥æ¼«ç”»æ ‡é¢˜",
                start_analysis: "å¼€å§‹åˆ†æ",
                computing: "æ­£åœ¨è®¡ç®—ç»“æœ...",
                result_title: "AI æœ€ä½³æ¨è",
                result_desc: "æ ¹æ®æ‚¨çš„ç‹¬ç‰¹åå¥½åˆ†æå¾—å‡ºã€‚",
                exclude: "ä¸å†æ¨è",
                view_now: "å»çœ‹çœ‹",
                new_analysis: "é‡æ–°åˆ†æ",
                exclude_msg: "ä»Šåå°†ä¸å†æ¨èæ­¤æ¼«ç”»ã€‚",
                like: "å–œæ¬¢",
                dislike: "ä¸å–œæ¬¢",
                share_copy: "ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼",
                share_fail: "å¤åˆ¶å¤±è´¥ã€‚",
                share_tpl_title: "[AIR.NW] AI æ¨èç»“æœ",
                share_tpl_link: "æˆ‘ä¹Ÿè¦è¯•è¯•",
                share_modal_title: "åˆ†äº«ç»“æœ",
                share_to_kakao: "KakaoTalk",
                share_to_line: "LINE",
                share_to_tiktok: "TikTok",
                share_to_text: "å¤åˆ¶ç»“æœ",
                share_to_system: "å…¶ä»–",
                conflict_msg: "è¿™æ˜¯æ‚¨åœ¨ç¬¬1æ­¥é€‰æ‹©çš„å–œå¥½æ ‡ç­¾ã€‚\nè¦æ”¹ä¸ºä¸å–œæ¬¢çš„å—ï¼Ÿ",
                yes: "æ˜¯",
                no: "å¦",
                main: "ä¸»é¡µ",
                ongoing: "è¿è½½ì¤‘",
                finished: "å·²å®Œç»“",
                login: "ç™»å½•",
                logout: "ç™»å‡º",
                email: "ç”µå­é‚®ä»¶",
                password: "å¯†ç ",
                login_btn: "ç™»å½•",
                signup_btn: "æ³¨å†Œ",
                auth_title: "ç™»å½• / æ³¨å†Œ",
                like: "å–œæ¬¢",
                my_info: "æˆ‘çš„ä¿¡æ¯",
                liked_list: "æˆ‘å–œæ¬¢çš„æ¼«ç”»",
                excluded_list: "æ’é™¤çš„æ¼«ç”»",
                delete_account: "æ³¨é”€è´¦å·",
                find_pw: "æ‰¾å›å¯†ç ",
                reset_pw_msg: "é‡ç½®å¯†ç é“¾æ¥å·²å‘é€è‡³æ‚¨çš„é‚®ç®±ã€‚",
                delete_confirm: "ç¡®å®šè¦æ³¨é”€è´¦å·å—ï¼Ÿ\næ‰€æœ‰ä¿å­˜çš„æ•°æ®å°†è¢«æ°¸ä¹…åˆ é™¤ã€‚",
                no_data: "æš‚æ— æ•°æ®ã€‚",
                password_confirm: "ç¡®è®¤å¯†ç ",
                pw_mismatch: "å¯†ç ä¸ä¸€è‡´ã€‚",
                pw_criteria: "å¯†ç é•¿åº¦è‡³å°‘ä¸º 6 ä½ã€‚",
                email_invalid: "è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€ã€‚",
                go_to_signup: "è¿˜æ²¡æœ‰è´¦å·ï¼Ÿæ³¨å†Œ",
                go_to_login: "å·²æœ‰è´¦å·ï¼Ÿç™»å½•",
                signup_confirm_msg: "ç¡®è®¤é‚®ä»¶å·²å‘é€ï¼è¯·æ£€æŸ¥æ‚¨çš„æ”¶ä»¶ç®±ã€‚",
                login_error_msg: "ç™»å½•ä¿¡æ¯æ— æ•ˆã€‚",
                signup_success: "æ³¨å†ŒæˆåŠŸï¼",
                worldcup: "æ¼«ç”»ä¸–ç•Œæ¯",
                worldcup_title: "æ¼«ç”»ç†æƒ³å‹ä¸–ç•Œæ¯",
                worldcup_select_round: "é€‰æ‹©è½®æ¬¡",
                worldcup_start: "å¼€å§‹",
                worldcup_vs: "VS",
                worldcup_round: "å¼º",
                worldcup_final: "å†³èµ›",
                worldcup_winner: "å† å†›",
                worldcup_result: "ä¸–ç•Œæ¯ç»“æœ",
                worldcup_history: "ä¸–ç•Œæ¯è®°å½•",
                exclude_from_reco: "æ’é™¤æ¨è",
                exclude_from_reco_desc: "å½±å“åå¥½ä½†ä¸åœ¨æ¨èç»“æœä¸­æ˜¾ç¤º",
                today_visitors: "ä»Šæ—¥",
                total_visitors: "æ€»è®¡"
            },
            ja: {
                subtitle: "My Pick Naver WebToon(with AI)",
                process: "åˆ†æãƒ—ãƒ­ã‚»ã‚¹",
                step: "ã‚¹ãƒ†ãƒƒãƒ—",
                of: "/",
                share: "å…±æœ‰ã™ã‚‹",
                step1_title: "ãŠå¥½ã¿ã®ã‚¿ã‚¤ãƒ—ã‚’é¸ã‚“ã§ãã ã•ã„",
                step1_desc: "1ã¤ä»¥ä¸Šã®é¸æŠãŒå¿…é ˆã§ã™ã€‚",
                cat_status: "é€£è¼‰çŠ¶æ…‹",
                cat_genre: "ãƒ¡ã‚¤ãƒ³ã‚¸ãƒ£ãƒ³ãƒ«",
                cat_topic: "äººæ°—ã®ç´ æ",
                cat_feature: "ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®ç‰¹å¾´",
                next: "æ¬¡ã¸",
                step2_title: "è‹¦æ‰‹ãªå¥½ã¿ã‚’é¸ã‚“ã§ãã ã•ã„ (ä»»æ„)",
                step2_desc: "é¸æŠã—ãŸã‚¿ã‚°ãŒå«ã¾ã‚Œã‚‹ä½œå“ã¯ãŠã™ã™ã‚ã‹ã‚‰é™¤å¤–ã•ã‚Œã¾ã™ã€‚",
                back: "æˆ»ã‚‹",
                continue: "ç¶šã‘ã‚‹",
                step3_title: "ä¸€ç•ªé¢ç™½ã‹ã£ãŸ\nã‚¦ã‚§ãƒ–ãƒˆã‚¥ãƒ¼ãƒ³ã¯ä½•ã§ã™ã‹ï¼Ÿ",
                step3_placeholder: "ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
                start_analysis: "åˆ†æé–‹å§‹",
                computing: "çµæœã‚’è¨ˆç®—ä¸­...",
                result_title: "AI ãŠã™ã™ã‚çµæœ",
                result_desc: "ã‚ãªãŸã®å¥½ã¿ã‚’åˆ†æã—ãŸçµæœã§ã™ã€‚",
                exclude: "ãŠã™ã™ã‚é™¤å¤–",
                view_now: "ë³´ëŸ¬ê°€ê¸°",
                new_analysis: "æ–°ã—ã„åˆ†æ",
                exclude_msg: "ä»Šå¾Œã€ã“ã®ä½œå“ã¯ãŠã™ã™ã‚ã•ã‚Œã¾ã›ã‚“ã€‚",
                like: "ãŠæ°—ã«å…¥ã‚Š",
                dislike: "å«Œã„",
                share_copy: "çµæœãŒã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸï¼",
                share_fail: "ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",
                share_tpl_title: "[AIR.NW] AI ãŠã™ã™ã‚çµæœ",
                share_tpl_link: "ã‚„ã£ã¦ã¿ã‚‹",
                share_modal_title: "çµæœã‚’å…±æœ‰",
                share_to_kakao: "KakaoTalk",
                share_to_line: "LINE",
                share_to_tiktok: "TikTok",
                share_to_text: "çµæœã‚³ãƒ”ãƒ¼",
                share_to_system: "ãã®ä»–",
                conflict_msg: "ã‚¹ãƒ†ãƒƒãƒ—1ã§é¸æŠã—ãŸå¥½ã¿ã‚¿ã‚°ã§ã™ã€‚\nè‹¦æ‰‹ãªã‚¿ã‚¤ãƒ—ã«å¤‰æ›´ã—ã¾ã™ã‹ï¼Ÿ",
                yes: "ã¯ã„",
                no: "ã„ã„ãˆ",
                main: "ãƒ¡ã‚¤ãƒ³",
                ongoing: "é€£è¼‰ä¸­",
                finished: "å®Œçµ",
                login: "ãƒ­ã‚°ã‚¤ãƒ³",
                logout: "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
                email: "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹",
                password: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰",
                login_btn: "ãƒ­ã‚°ã‚¤ãƒ³",
                signup_btn: "æ–°è¦ç™»éŒ²",
                auth_title: "ãƒ­ã‚°ã‚¤ãƒ³ / æ–°è¦ç™»éŒ²",
                like: "ãŠæ°—ã«å…¥ã‚Š",
                my_info: "ãƒã‚¤æƒ…å ±",
                liked_list: "ãŠæ°—ã«å…¥ã‚Šä½œå“",
                excluded_list: "é™¤å¤–ã—ãŸä½œå“",
                delete_account: "ä¼šå“¡è„±é€€",
                find_pw: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸå ´åˆ",
                reset_pw_msg: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šãƒªãƒ³ã‚¯ã‚’ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡ã—ã¾ã—ãŸã€‚",
                delete_confirm: "æœ¬å½“ã«é€€ä¼šã—ã¾ã™ã‹ï¼Ÿ\nä¿å­˜ã•ã‚ŒãŸã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå‰Šé™¤ã•ã‚Œã¾ã™ã€‚",
                no_data: "ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚",
                password_confirm: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†ç¢ºèª",
                pw_mismatch: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“ã€‚",
                pw_criteria: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯6æ–‡å­—ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚",
                email_invalid: "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
                go_to_signup: "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„ã§ã™ã‹ï¼Ÿ æ–°è¦ç™»éŒ²",
                go_to_login: "ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ ãƒ­ã‚°ã‚¤ãƒ³",
                signup_confirm_msg: "ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚",
                login_error_msg: "ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚",
                signup_success: "ä¼šå“¡ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸï¼",
                worldcup: "ã‚¦ã‚§ãƒ–ãƒˆã‚¥ãƒ¼ãƒ³ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—",
                worldcup_title: "ã‚¦ã‚§ãƒ–ãƒˆã‚¥ãƒ¼ãƒ³ç†æƒ³å‹ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—",
                worldcup_select_round: "ãƒ©ã‚¦ãƒ³ãƒ‰é¸æŠ",
                worldcup_start: "ã‚¹ã‚¿ãƒ¼ãƒˆ",
                worldcup_vs: "VS",
                worldcup_round: "å¼·",
                worldcup_final: "æ±ºå‹",
                worldcup_winner: "å„ªå‹",
                worldcup_result: "ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—çµæœ",
                worldcup_history: "ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚«ãƒƒãƒ—è¨˜éŒ²",
                exclude_from_reco: "æ¨è–¦é™¤å¤–",
                exclude_from_reco_desc: "å¥½ã¿ã«å½±éŸ¿ã™ã‚‹ãŒæ¨è–¦çµæœã‹ã‚‰ã¯é™¤å¤–ã•ã‚Œã¾ã™",
                today_visitors: "ä»Šæ—¥",
                total_visitors: "ç´¯è¨ˆ"
            }
        };

        const getGenreCategories = (t) => [
            { name: t.cat_status, genres: ["ì—°ì¬ì¤‘", "ì™„ê²°"], en: ["Ongoing", "Finished"], zh: ["è¿è½½ä¸­", "å·²å®Œç»“"], ja: ["é€£è¼‰ä¸­", "å®Œçµ"] },
            {
                name: t.cat_genre,
                genres: ["ë¡œë§¨ìŠ¤", "íŒíƒ€ì§€", "ì•¡ì…˜", "ë“œë¼ë§ˆ", "ìŠ¤ë¦´ëŸ¬", "ë¬´í˜‘/ì‚¬ê·¹", "ê°œê·¸", "ì¼ìƒ", "ê°ì„±", "ìŠ¤í¬ì¸ "],
                en: ["Romance", "Fantasy", "Action", "Drama", "Thriller", "Martial Arts", "Comedy", "Life", "Sensibility", "Sports"],
                zh: ["æµªæ¼«", "å¥‡å¹»", "åŠ¨ä½œ", "å‰§æƒ…", "æƒŠæ‚š", "æ­¦ä¾ /å²å‰§", "æç¬‘", "æ—¥å¸¸", "æ„Ÿæ€§", "ä½“è‚²"],
                ja: ["ãƒ­ãƒãƒ³ã‚¹", "ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼", "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³", "ãƒ‰ãƒ©ãƒ", "ã‚¹ãƒªãƒ©ãƒ¼", "æ­¦ä¾ /æ™‚ä»£åŠ‡", "ã‚®ãƒ£ã‚°", "æ—¥å¸¸", "æ„Ÿì„±", "ìŠ¤í¬ì¸ "]
            },
            {
                name: t.cat_topic,
                genres: ["íšŒê·€", "ë¹™ì˜", "ë¨¼ì¹˜í‚¨", "ì•„ì´ëŒ", "ê²Œì„íŒíƒ€ì§€", "ë³µìˆ˜", "í•™ì›ë¬¼", "ì˜¤í”¼ìŠ¤", "ë¡œíŒ", "ì´ì„¸ê³„"],
                en: ["Regression", "Possession", "Munchkin", "Idol", "Game Fantasy", "Revenge", "School", "Office", "Rom-Fantasy", "Isekai"],
                zh: ["å›å½’", "é™„èº«", "é¾™å‚²å¤©", "å¶åƒ", "æ¸¸æˆå¥‡å¹»", "å¤ä»‡", "æ ¡å›­", "èŒåœº", "ç½—æ›¼å¥‡å¹»", "å¼‚ä¸–ç•Œ"],
                ja: ["å›å¸°", "æ†‘ä¾", "æœ€å¼·", "ã‚¢ã‚¤ãƒ‰ãƒ«", "ê²Œì„íŒíƒ€ì§€", "å¾©è®", "å­¦åœ’ã‚‚ã®", "ã‚ªãƒ•ã‚£ã‚¹", "ë¡œíŒ", "ç•°ä¸–ç•Œ"]
            },
            {
                name: t.cat_feature,
                genres: ["ì‚¬ì´ë‹¤", "íë§", "ì„±ì¥ë¬¼", "ë‘ë‡Œì‹¸ì›€", "ì„œìŠ¤íœìŠ¤"],
                en: ["Satisfying", "Healing", "Growth", "Brain Battle", "Suspense"],
                zh: ["çˆ½æ–‡", "æ²»æ„ˆ", "æˆé•¿", "è„‘åŠ›æˆ˜", "æ‚¬ç–‘"],
                ja: ["ã‚¹ã‚«ãƒƒã¨", "ãƒ’ãƒ¼ãƒªãƒ³ã‚°", "æˆé•·ã‚‚ã®", "é ­è„³æˆ¦", "ã‚µã‚¹ãƒšãƒ³ã‚¹"]
            }
        ];

        // ìœ ì‚¬ ì¥ë¥´ ë§¤í•‘ - ë©”ì¸ ì¥ë¥´ ì„ íƒ ì‹œ ê´€ë ¨ íƒœê·¸ë„ í•¨ê»˜ ë°˜ì˜
        const RELATED_GENRES = {
            // ë©”ì¸ ì¥ë¥´
            "ë¡œë§¨ìŠ¤": ["ìˆœì •", "ëŸ¬ë¸Œ", "ì—°ì• ", "ì„¤ë ˜", "ë‹¬ë‹¬", "ì†Œê°œíŒ…", "ì§ì‚¬ë‘", "ì²­ì¶˜ë¡œë§¨ìŠ¤", "í•™ì›ë¡œë§¨ìŠ¤", "ë¦¬ì–¼ë¡œë§¨ìŠ¤", "ê³ ìê·¹ë¡œë§¨ìŠ¤", "í˜ê´€ë¡œë§¨ìŠ¤", "ì„ ê²°ë¡œë§¨ìŠ¤", "ë¡œì½”", "ëŸ¬ë¸”ë¦¬", "ì§ì§„ë‚¨", "ì§ì§„ë…€", "ìˆœì• ", "ê°ì„±ë¡œë§¨ìŠ¤"],
            "íŒíƒ€ì§€": ["ë§ˆë²•", "ë˜ì „", "ì´ì„¸ê³„", "í—Œí„°ë¬¼", "ì¤‘ì„¸íŒíƒ€ì§€", "ë™ì–‘í’íŒíƒ€ì§€", "ì•¡ì…˜íŒíƒ€ì§€", "ë‹¤í¬íŒíƒ€ì§€", "ê²Œì„íŒíƒ€ì§€", "íŒë¬´", "ìš©ì‚¬", "ë§ˆì™•", "ì‹ í™”", "ì„¸ê³„ê´€", "ì´ëŠ¥ë ¥", "ì´ˆëŠ¥ë ¥", "ë§ˆê²€"],
            "ì•¡ì…˜": ["ë°°í‹€", "ì „íˆ¬", "ê²©íˆ¬", "ê²©íˆ¬ê¸°", "ì´ëŠ¥ë ¥ë°°í‹€ë¬¼", "ì•¡ì…˜íŒíƒ€ì§€", "ì•¡ì…˜ì•„í¬ì¹¼ë¦½ìŠ¤", "ì‹¸ì›€", "ì „ìŸ", "ì—´í˜ˆ", "ì†Œë…„ì™•ë„ë¬¼"],
            "ë“œë¼ë§ˆ": ["ê°ì„±ë“œë¼ë§ˆ", "ì„±ì¥ë“œë¼ë§ˆ", "ì§ì—…ë“œë¼ë§ˆ", "ê³ ìê·¹ë“œë¼ë§ˆ", "ê°ë™", "í•˜ì´í¼ë¦¬ì–¼ë¦¬ì¦˜", "ì¸ê°„ë“œë¼ë§ˆ", "ì‚¬íšŒê³ ë°œ", "ì‚¬ì—°"],
            "ìŠ¤ë¦´ëŸ¬": ["ê³µí¬", "í˜¸ëŸ¬", "ë¯¸ìŠ¤í„°ë¦¬", "ì„œìŠ¤íœìŠ¤", "ê³ ìê·¹ìŠ¤ë¦´ëŸ¬", "ë²”ì£„", "ì¶”ë¦¬", "ê¸´ì¥ê°", "ì˜¤ì»¬íŠ¸", "ê·€ì‹ ", "ì‚´ì¸", "ì”í˜¹"],
            "ë¬´í˜‘/ì‚¬ê·¹": ["ë¬´í˜‘", "ì‚¬ê·¹", "ì •í†µë¬´í˜‘", "ì‹œëŒ€ë¬¼", "ë™ì–‘", "ë™ì–‘í’íŒíƒ€ì§€", "íŒë¬´", "ì¤‘êµ­", "ì¡°ì„ ", "ê¶ì¤‘"],
            "ê°œê·¸": ["ì½”ë¯¸ë””", "ë³‘ë§›", "ì¼ìƒê°œê·¸", "íŒíƒ€ì§€ê°œê·¸", "ì¼ìƒê°œê·¸íë§", "ê°œê·¸ë¬¼", "ì›ƒê¸´", "ìœ ë¨¸", "4ì°¨ì›", "ê³µê°ì„±ìˆ˜ì¹˜"],
            "ì¼ìƒ": ["ì¼ìƒë¬¼", "ìŠ¬ë¼ì´ìŠ¤ì˜¤ë¸Œë¼ì´í”„", "íë§", "ì”ì”", "ê³µê°", "ê°€ë²¼ìš´", "ë¬´í•´í•œ", "ì†Œì†Œí•œ", "ì»·íˆ°"],
            "ê°ì„±": ["ê°ì„±ì ì¸", "ê°ë™", "ëˆˆë¬¼", "íë§", "ë”°ëœ»í•œ", "ì”ì”", "ì‹¬ì¿µ", "ì„¤ë ˜"],
            "ìŠ¤í¬ì¸ ": ["ìš´ë™", "ì¶•êµ¬", "ì•¼êµ¬", "ë†êµ¬", "ë°°êµ¬", "ê²©íˆ¬ê¸°", "ë³µì‹±", "ë¬´ìˆ "],
            // ì¸ê¸° ì†Œì¬
            "íšŒê·€": ["íƒ€ì„ìŠ¬ë¦½", "ì‹œê°„ì´ë™", "ê³¼ê±°íšŒê·€", "í™˜ìƒ", "ë¦¬ì…‹", "ë‹¤ì‹œì‹œì‘", "ë‘ë²ˆì§¸ì¸ìƒ"],
            "ë¹™ì˜": ["ë¹™ì˜ë¬¼", "ì˜í˜¼ì´ë™", "íŠ¸ëœìŠ¤", "ëª¸ë°”ê¿ˆ", "í™˜ìƒ", "ì „ìƒ"],
            "ë¨¼ì¹˜í‚¨": ["ì‚¬ê¸°ìº", "ìµœê°•", "ë¬´ìŒ", "ê³ ì¸ë¬¼", "í˜ìˆ¨ì°", "ì••ë„ì ", "ì„±ì¥ë¬¼"],
            "ì•„ì´ëŒ": ["ì—°ì˜ˆì¸", "ì•„ì´ëŒë¬¼", "ìŠ¤íƒ€", "íŒ¬ë¤", "ì…€ëŸ½", "ì—°ì˜ˆê³„"],
            "ê²Œì„íŒíƒ€ì§€": ["ê²Œì„", "ìƒíƒœì°½", "ë ˆë²¨ì—…", "ì‹œìŠ¤í…œ", "ìŠ¤íƒ¯", "í—Œí„°ë¬¼", "ë˜ì „ë¬¼", "í”Œë ˆì´ì–´"],
            "ë³µìˆ˜": ["ë³µìˆ˜ê·¹", "ë³µìˆ˜ë¬¼", "ì‚¬ì´ë‹¤", "í”¼ì¹´ë ˆìŠ¤í¬", "ì°¸êµìœ¡"],
            "í•™ì›ë¬¼": ["í•™êµ", "í•™ìƒ", "ê³ ë“±í•™êµ", "ëŒ€í•™êµ", "ì²­ì¶˜", "í•˜ì´í‹´", "êµë³µ"],
            "ì˜¤í”¼ìŠ¤": ["íšŒì‚¬", "ì§ì¥", "ì‚¬ë¬´ì‹¤", "ì§ì¥ì¸", "ë¹„ì¦ˆë‹ˆìŠ¤", "CEO", "ì¬ë²Œ"],
            "ë¡œíŒ": ["ë¡œë§¨ìŠ¤íŒíƒ€ì§€", "ì„±ì¥ë¡œíŒ", "ì—¬ì£¼", "ê³µì‘", "í™©ì œ", "í™©ë…€", "ì™•ì¡±/ê·€ì¡±", "ë¹™ì˜"],
            "ì´ì„¸ê³„": ["ì´ì„¸ê³„ë¬¼", "ì°¨ì›ì´ë™", "ì†Œí™˜", "ë‹¤ë¥¸ì„¸ê³„", "í‰í–‰ì„¸ê³„", "ì´ê³„"],
            // ìŠ¤í† ë¦¬ íŠ¹ì§•
            "ì‚¬ì´ë‹¤": ["í†µì¾Œ", "ì‹œì›", "ì°¸êµìœ¡", "ë³µìˆ˜", "í”¼ì¹´ë ˆìŠ¤í¬"],
            "íë§": ["íë§ë¬¼", "ë”°ëœ»í•œ", "ì”ì”", "ë¬´í•´í•œ", "íœ´ì‹", "ìœ„ë¡œ", "ì¼ìƒê°œê·¸íë§"],
            "ì„±ì¥ë¬¼": ["ì„±ì¥", "ì„±ì¥ë“œë¼ë§ˆ", "ì„±ì¥ë¡œíŒ", "ì†Œë…„ì™•ë„ë¬¼", "ì£¼ì¸ê³µì„±ì¥"],
            "ë‘ë‡Œì‹¸ì›€": ["ì‹¬ë¦¬ì „", "ì „ëµ", "ë§ˆì¸ë“œê²Œì„", "ì§€ëŠ¥ì „", "ê³„ëµ", "ìŒëª¨"],
            "ì„œìŠ¤íœìŠ¤": ["ê¸´ì¥ê°", "ë¯¸ìŠ¤í„°ë¦¬", "ìŠ¤ë¦´ëŸ¬", "ì¶”ë¦¬", "ë°˜ì „"]
        };

        // ì„ íƒí•œ ì¥ë¥´ë¥¼ í™•ì¥í•˜ì—¬ ê´€ë ¨ ì¥ë¥´ í‚¤ì›Œë“œ ë°°ì—´ ë°˜í™˜
        const expandGenres = (selectedGenres) => {
            const expanded = new Set();
            selectedGenres.forEach(genre => {
                // ì›ë³¸ ì¥ë¥´ ì¶”ê°€
                if (genre.includes('/')) {
                    genre.split('/').forEach(g => expanded.add(g.trim()));
                } else {
                    expanded.add(genre);
                }
                // ê´€ë ¨ ì¥ë¥´ ì¶”ê°€
                const related = RELATED_GENRES[genre];
                if (related) {
                    related.forEach(r => expanded.add(r));
                }
            });
            return Array.from(expanded);
        };

        const MOCK_WEBTOONS = [
            { id: "641253", title: "ì™¸ëª¨ì§€ìƒì£¼ì˜", tags: ["ì—í”¼ì†Œë“œ", "ì•¡ì…˜", "ë°•íƒœì¤€", "ê¸ˆìš”ì›¹íˆ°"], thumbnail: "https://image-comic.pstatic.net/webtoon/641253/thumbnail/thumbnail_IMAG21_d894f11f-668a-4046-8692-730a961f7743.jpg", match: 98, status: 'ONGOING' },
            { id: "183559", title: "ì‹ ì˜ íƒ‘", tags: ["íŒíƒ€ì§€", "ë¨¼ì¹˜í‚¨", "ì¥ëŒ€í•œì„œì‚¬"], thumbnail: "https://image-comic.pstatic.net/webtoon/183559/thumbnail/thumbnail_IMAG21_56133031-69f8-45a7-96a9-858348b4e720.jpg", match: 96, status: 'ONGOING' }
        ];

        const ProgressBar = ({ step, t }) => (
            <div className="mb-10 max-w-2xl mx-auto px-6">
                <div className="h-2 w-full bg-gray-200 rounded-full overflow-hidden">
                    <div className="h-full bg-primary transition-all duration-700 ease-out" style={{ width: `${(step / 4) * 100}%` }}></div>
                </div>
                <div className="mt-4 flex justify-between text-[11px] font-bold text-gray-400 uppercase tracking-widest">
                    <span>{t.process}</span>
                    <span className="text-primary">{t.step} {step} {t.of} 4</span>
                </div>
            </div>
        );

        const WebtoonCard = ({ item, rank, onDislike, onLike, onExcludeFromResult, isLiked, isDisliked, t }) => {
            const isFinished = item.status === 'FINISHED';
            return (
                <div className="flex flex-col gap-3 group relative bg-white p-4 rounded-3xl shadow-sm hover:shadow-xl transition-all duration-300">
                    <div className="relative aspect-[3/4] rounded-2xl overflow-hidden shadow-md">
                        <img
                            src={item.thumbnail}
                            alt={item.title}
                            referrerPolicy="no-referrer"
                            className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                            loading="lazy"
                            onError={(e) => { e.target.src = "https://via.placeholder.com/300x400?text=No+Image"; }}
                        />
                        <div className="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-60"></div>

                        {rank > 0 && <div className="absolute top-3 left-3 bg-[#00DC64] text-white font-black text-xl italic px-2.5 py-0.5 rounded-xl shadow-lg z-10 drop-shadow-md">#{rank}</div>}

                        <div className="absolute bottom-3 left-3 flex gap-1">
                            {isFinished && <span className="bg-black/70 backdrop-blur-md text-white text-[10px] font-bold px-2 py-1 rounded-lg">{t.finished}</span>}
                            {!isFinished && <span className="bg-[#00DC64]/90 backdrop-blur-md text-white text-[10px] font-bold px-2 py-1 rounded-lg">{t.ongoing}</span>}
                        </div>

                        {/* Top Right Heart Button */}
                        <button
                            onClick={(e) => { e.stopPropagation(); onLike(item.id); }}
                            className={`absolute top-3 right-3 p-2.5 rounded-full backdrop-blur-md transition-all z-10 ${isLiked ? 'bg-red-500 text-white shadow-lg scale-110' : 'bg-black/20 text-white/70 hover:bg-white hover:text-red-500'}`}
                        >
                            <svg viewBox="0 0 24 24" className="w-5 h-5 fill-current"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>
                        </button>
                    </div>

                    <div className="flex flex-col gap-1.5">
                        <div className="flex justify-between items-start">
                            <h3 className="font-black text-gray-900 text-[15px] truncate group-hover:text-[#00DC64] transition-colors leading-tight">{item.title}</h3>
                            <div className="flex items-center gap-0.5 text-yellow-400 flex-shrink-0 bg-yellow-50 px-1.5 py-0.5 rounded-lg">
                                <svg viewBox="0 0 24 24" className="w-3.5 h-3.5 fill-current"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>
                                <span className="text-[11px] font-black text-gray-900">{item.starScore ? item.starScore.toFixed(2) : "0.0"}</span>
                            </div>
                        </div>
                        <p className="text-[12px] text-gray-400 font-bold truncate">{item.author}</p>
                    </div>

                    <div className="flex flex-col gap-2 mt-2">
                        <a
                            href={`https://comic.naver.com/webtoon/list?titleId=${item.id}`}
                            target="_blank"
                            className="w-full py-2.5 bg-[#00DC64] hover:bg-[#00c65a] text-white font-black text-[13px] rounded-xl text-center shadow-sm hover:shadow-md transition-all flex items-center justify-center gap-2"
                        >
                            <span>{t.view_now}</span>
                            <svg viewBox="0 0 24 24" className="w-4 h-4 fill-current"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg>
                        </a>

                        <div className="flex gap-1.5">
                            <button
                                onClick={(e) => { e.stopPropagation(); onLike(item.id); }}
                                className={`flex-1 py-2 rounded-xl font-bold text-[10px] transition-all border flex items-center justify-center gap-1 ${isLiked ? 'bg-red-50 text-red-500 border-red-100' : 'bg-gray-50 text-gray-400 border-transparent hover:bg-gray-100 hover:text-gray-600'}`}
                            >
                                <svg viewBox="0 0 24 24" className={`w-3.5 h-3.5 ${isLiked ? 'fill-current' : 'fill-none stroke-current stroke-2'}`}><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>
                                {t.like}
                            </button>
                            <button
                                onClick={(e) => { e.stopPropagation(); onDislike(item.id); }}
                                className={`flex-1 py-2 rounded-xl font-bold text-[10px] transition-all border flex items-center justify-center gap-1 ${isDisliked ? 'bg-gray-800 text-white border-gray-800' : 'bg-gray-50 text-gray-400 border-transparent hover:bg-gray-100 hover:text-gray-600'}`}
                            >
                                <svg viewBox="0 0 24 24" className="w-3.5 h-3.5 fill-none stroke-current stroke-2"><path d="M10 14h4M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                {t.dislike}
                            </button>
                            {onExcludeFromResult && (
                                <button
                                    onClick={(e) => { e.stopPropagation(); onExcludeFromResult(item.id); }}
                                    className="flex-1 py-2 rounded-xl font-bold text-[10px] transition-all border bg-gray-50 text-gray-400 border-transparent hover:bg-red-50 hover:text-red-600 hover:border-red-100 flex items-center justify-center gap-1"
                                >
                                    <svg viewBox="0 0 24 24" className="w-3.5 h-3.5 fill-current"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg>
                                    {t.exclude}
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const ShareModal = ({ isOpen, onClose, t, results }) => {
            const supabase = supabaseInstance;
            useEffect(() => {
                if (isOpen) {
                    document.body.classList.add('modal-open');
                    initKakao();
                } else { document.body.classList.remove('modal-open'); }
                return () => document.body.classList.remove('modal-open');
            }, [isOpen]);

            if (!isOpen) return null;

            const shareUrl = window.location.href;
            const fullRankText = results.map((w, i) => `${i + 1}. ${w.title} (${w.status === 'FINISHED' ? t.finished : t.ongoing})`).join('\n');
            const shareText = `${t.share_tpl_title}\n\n${fullRankText}\n\nğŸ”— ${t.share_tpl_link}: ${shareUrl}`;

            const copyToClip = () => {
                const el = document.createElement('textarea');
                el.value = shareText;
                document.body.appendChild(el);
                el.select();
                try { document.execCommand('copy'); alert(t.share_copy); } catch (e) { alert(t.share_fail); }
                document.body.removeChild(el);
                onClose();
            };

            const shareToKakao = () => {
                if (window.Kakao && Kakao.isInitialized()) {
                    try {
                        Kakao.Share.sendDefault({
                            objectType: 'feed',
                            content: {
                                title: t.share_tpl_title,
                                description: results.slice(0, 3).map(w => w.title).join(', ') + ' ë“± ì¶”ì²œë¨',
                                imageUrl: results[0]?.thumbnail || 'https://comic.naver.com/static/img/common/naver_shared.png',
                                link: { mobileWebUrl: shareUrl, webUrl: shareUrl },
                            },
                            buttons: [{ title: t.share_tpl_link, link: { mobileWebUrl: shareUrl, webUrl: shareUrl } }],
                        });
                        return;
                    } catch (e) { console.error(e); }
                }
                if (navigator.share) { navigator.share({ title: t.share_tpl_title, text: shareText, url: shareUrl }).catch(() => { }); }
                else copyToClip();
            };

            const shareToLine = () => { window.open(`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(shareText)}`, '_blank'); };

            return (
                <div className="modal-container" onClick={onClose}>
                    <div className="modal-content-box" onClick={e => e.stopPropagation()}>
                        <div className="bg-white w-full max-w-sm rounded-[56px] shadow-2xl overflow-hidden animate-up">
                            <div className="pt-12 pb-10 px-8">
                                <h3 className="text-2xl font-black text-center mb-10 tracking-tight">{t.share_modal_title}</h3>
                                <div className="grid grid-cols-2 gap-4 mb-8">
                                    <button onClick={shareToKakao} className="premium-gray-btn flex flex-col items-center gap-4 p-8 rounded-[36px]">
                                        <div className="w-16 h-16 flex items-center justify-center bg-[#FEE500] rounded-[24px] shadow-sm overflow-hidden"><img src="https://upload.wikimedia.org/wikipedia/commons/e/e3/KakaoTalk_logo.svg" className="w-10 h-10 object-contain" alt="Kakao" /></div>
                                        <span className="text-sm font-black text-gray-700">{t.share_to_kakao}</span>
                                    </button>
                                    <button onClick={shareToLine} className="premium-gray-btn flex flex-col items-center gap-4 p-8 rounded-[36px]">
                                        <div className="w-16 h-16 flex items-center justify-center bg-[#06C755] rounded-[22px] shadow-sm overflow-hidden"><img src="https://upload.wikimedia.org/wikipedia/commons/4/41/LINE_logo.svg" className="w-10 h-10 object-contain" alt="LINE" /></div>
                                        <span className="text-sm font-black text-gray-700">{t.share_to_line}</span>
                                    </button>
                                    <button onClick={copyToClip} className="premium-gray-btn flex flex-col items-center gap-4 p-8 rounded-[36px]">
                                        <div className="w-16 h-16 flex items-center justify-center bg-black rounded-[22px] shadow-sm overflow-hidden"><img src="https://www.logo.wine/a/logo/TikTok/TikTok-Icon-Logo.wine.svg" className="w-[85%] h-[85%] object-contain" alt="TikTok" style={{ filter: 'brightness(1.5)' }} /></div>
                                        <span className="text-sm font-black text-gray-700">{t.share_to_tiktok}</span>
                                    </button>
                                    <button onClick={copyToClip} className="premium-gray-btn flex flex-col items-center gap-4 p-8 rounded-[36px]">
                                        <div className="w-16 h-16 flex items-center justify-center bg-slate-200 rounded-[22px] shadow-sm overflow-hidden text-slate-600"><svg viewBox="0 0 24 24" className="w-8 h-8 fill-current"><path d="M7 6V3C7 2.44772 7.44772 2 8 2H20C20.5523 2 21 2.44772 21 3V17C21 17.5523 20.5523 18 20 18H17V21C17 21.5523 16.5523 22 16 22H4C3.44772 22 3 21.5523 3 21V7C3 6.44772 3.44772 6 4 6H7ZM9 6H16V16H17V4H9V6ZM5 8V20H15V8H5Z"></path></svg></div>
                                        <span className="text-sm font-black text-gray-700">{t.share_to_text}</span>
                                    </button>
                                </div>
                                <button onClick={onClose} className="w-full py-5 bg-gray-50 rounded-2xl text-gray-400 font-black">CLOSE</button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        const HelpModal = ({ isOpen, onClose, t }) => {
            const supabase = supabaseInstance;
            if (!isOpen) return null;
            return (
                <div className="modal-container" onClick={onClose}>
                    <div className="modal-content-box" onClick={e => e.stopPropagation()}>
                        <div className="bg-white w-full max-w-2xl rounded-[40px] shadow-2xl p-10 animate-up">
                            <h3 className="text-3xl font-black mb-8 text-primary">Nì›¹íˆ° íŒŒì¸ë” ê°€ì´ë“œ ğŸ“˜</h3>

                            <div className="space-y-6">
                                <div className="p-5 bg-gray-50 rounded-3xl">
                                    <h4 className="font-black text-lg mb-2">1. ğŸ” ë˜‘ë˜‘í•œ ê²€ìƒ‰</h4>
                                    <p className="text-gray-600 text-sm leading-relaxed">ì œëª©ì´ë‚˜ ì‘ê°€ëŠ” ë¬¼ë¡ , "ë¨¼ì¹˜í‚¨", "íšŒê·€", "ë¡œë§¨ìŠ¤" ê°™ì€ í‚¤ì›Œë“œë¡œë„ ê²€ìƒ‰í•  ìˆ˜ ìˆì–´ìš”. ì›í•˜ëŠ” ì·¨í–¥ì„ ì…ë ¥ë§Œ í•˜ì„¸ìš”!</p>
                                </div>

                                <div className="p-5 bg-gray-50 rounded-3xl">
                                    <h4 className="font-black text-lg mb-2">2. âœ¨ ë§ì¶¤ ì¶”ì²œë°›ê¸°</h4>
                                    <p className="text-gray-600 text-sm leading-relaxed">'ì¶”ì²œë°›ê¸°' ë©”ë‰´ì—ì„œ 4ë‹¨ê³„ì˜ ê°„ë‹¨í•œ ì§ˆë¬¸ì— ë‹µí•´ë³´ì„¸ìš”. AIê°€ ìˆ˜ì²œ ê°œì˜ ì›¹íˆ° ì¤‘ ë‹¹ì‹ ì—ê²Œ ë”± ë§ëŠ” ì‘í’ˆì„ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤.</p>
                                </div>

                                <div className="p-5 bg-gray-50 rounded-3xl">
                                    <h4 className="font-black text-lg mb-2">3. ğŸ† ì›¹íˆ° ì›”ë“œì»µ</h4>
                                    <p className="text-gray-600 text-sm leading-relaxed">ìµœëŒ€ 2048ê°•ê¹Œì§€! ë‚˜ë§Œì˜ ìµœì•  ì›¹íˆ°ì„ ë½‘ëŠ” í† ë„ˆë¨¼íŠ¸ë¥¼ ì¦ê²¨ë³´ì„¸ìš”. ìš°ìŠ¹ì‘ì€ ë‹¹ì‹ ì˜ ì·¨í–¥ ë¶„ì„ì—ë„ ë°˜ì˜ë©ë‹ˆë‹¤.</p>
                                </div>

                                <div className="p-5 bg-gray-50 rounded-3xl">
                                    <h4 className="font-black text-lg mb-2">4. ğŸ“š ë‚˜ë§Œì˜ ì»¬ë ‰ì…˜ ê³µìœ </h4>
                                    <p className="text-gray-600 text-sm leading-relaxed">ë§ˆìŒì— ë“œëŠ” ì‘í’ˆì€ ì¸ë„¤ì¼ì˜ 'â¤ï¸' ë²„íŠ¼ì„ ëˆŒëŸ¬ ì»¬ë ‰ì…˜ì— ì¶”ê°€í•˜ì„¸ìš”. 'ë‚´ ì •ë³´ {'>'} ë‚˜ì˜ ì»¬ë ‰ì…˜'ì—ì„œ ì¹œêµ¬ë“¤ì—ê²Œ ë¦¬ìŠ¤íŠ¸ë¥¼ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                                </div>
                            </div>

                            <button onClick={onClose} className="w-full mt-8 py-4 bg-black text-white font-black rounded-2xl text-lg hover:scale-[1.02] active:scale-95 transition-all">
                                í™•ì¸í–ˆì–´ìš”!
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const WorldcupModal = ({ isOpen, onClose, t, user, onSaveResult, isViewMode = false }) => {
            const supabase = supabaseInstance;
            const [stage, setStage] = useState('select'); // 'select', 'playing', 'result'
            const [selectedRound, setSelectedRound] = useState(16);
            const [matches, setMatches] = useState([]);
            const [currentMatchIndex, setCurrentMatchIndex] = useState(0);
            const [winners, setWinners] = useState([]);
            const [finalWinner, setFinalWinner] = useState(null);

            useEffect(() => {
                if (isOpen && !isViewMode) {
                    document.body.classList.add('modal-open');
                } else {
                    document.body.classList.remove('modal-open');
                }
                return () => document.body.classList.remove('modal-open');
            }, [isOpen, isViewMode]);

            if (!isOpen) return null;

            const startWorldcup = () => {
                const rawData = window.WEBTOON_DATA || MOCK_WEBTOONS;
                if (rawData.length < selectedRound) {
                    alert(`ì›¹íˆ° ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ìµœì†Œ ${selectedRound}ê°œ í•„ìš”í•©ë‹ˆë‹¤.`);
                    return;
                }

                // Shuffle and select webtoons
                const shuffled = [...rawData].sort(() => Math.random() - 0.5);
                const selected = shuffled.slice(0, selectedRound);

                // Create initial matches
                const initialMatches = [];
                for (let i = 0; i < selected.length; i += 2) {
                    initialMatches.push([selected[i], selected[i + 1]]);
                }

                setMatches(initialMatches);
                setCurrentMatchIndex(0);
                setWinners([]);
                setStage('playing');
            };

            const selectWinner = (webtoon) => {
                const newWinners = [...winners, webtoon];

                if (currentMatchIndex + 1 < matches.length) {
                    // Move to next match
                    setCurrentMatchIndex(currentMatchIndex + 1);
                    setWinners(newWinners);
                } else {
                    // Round complete
                    if (newWinners.length === 1) {
                        // Tournament complete!
                        setFinalWinner(newWinners[0]);
                        setStage('result');
                        saveWorldcupResult(newWinners[0], selectedRound);
                    } else {
                        // Start next round
                        const nextMatches = [];
                        for (let i = 0; i < newWinners.length; i += 2) {
                            nextMatches.push([newWinners[i], newWinners[i + 1]]);
                        }
                        setMatches(nextMatches);
                        setCurrentMatchIndex(0);
                        setWinners([]);
                    }
                }
            };

            const saveWorldcupResult = async (winner, round) => {
                if (!user) return;

                const result = {
                    user_id: user.id,
                    winner_id: winner.titleId || winner.id,
                    winner_title: winner.titleName || winner.title,
                    round: round,
                    created_at: new Date().toISOString()
                };

                await supabaseClient.from('worldcup_results').insert(result);
                if (onSaveResult) onSaveResult(result);
            };

            const getCurrentRound = () => {
                const remaining = matches.length * 2;
                if (remaining === 2) return t.worldcup_final;
                return `${remaining}${t.worldcup_round}`;
            };

            const rounds = [8, 16, 32, 64, 128, 256, 512, 1024, 2048];

            const content = (
                <div className={`${isViewMode ? 'bg-transparent' : 'bg-white w-full max-w-4xl rounded-[56px] shadow-2xl overflow-hidden'} animate-up`}>
                    <div className="p-10">
                        {stage === 'select' && (
                            <div className="text-center py-10">
                                <h3 className="text-3xl font-black mb-10 tracking-tight italic border-b-2 border-primary/10 inline-block">{t.worldcup_title}</h3>
                                <p className="text-gray-400 font-medium mb-10 italic">{t.worldcup_desc}</p>
                                <div className="grid grid-cols-3 sm:grid-cols-5 gap-3 max-w-2xl mx-auto mb-12">
                                    {rounds.map(r => (
                                        <button key={r} onClick={() => setSelectedRound(r)} className={`px-4 py-3 rounded-2xl font-black transition-all ${selectedRound === r ? 'bg-primary text-white shadow-xl scale-105' : 'bg-gray-50 text-gray-300 hover:bg-gray-100'}`}>{r}{t.worldcup_round}</button>
                                    ))}
                                </div>
                                <button onClick={startWorldcup} className="w-full max-w-sm py-6 bg-primary text-white font-black rounded-full shadow-2xl hover:scale-105 active:scale-95 transition-all text-xl uppercase tracking-widest">
                                    {t.start || "ì‹œì‘í•˜ê¸°"}
                                </button>
                            </div>
                        )}

                        {stage === 'playing' && (
                            <div className="text-center py-10">
                                <div className="mb-8"><span className="px-6 py-2 bg-primary text-white text-sm font-black rounded-full shadow-md uppercase tracking-widest">{getCurrentRound()}</span></div>
                                <div className="flex flex-col md:flex-row items-center justify-center gap-12 sm:gap-20">
                                    {matches[currentMatchIndex].map((w, idx) => (
                                        <div key={idx} onClick={() => selectWinner(w)} className="group cursor-pointer transform transition-all hover:scale-105 active:scale-95 duration-500">
                                            <div className="relative w-56 sm:w-72 aspect-[3/4] rounded-[48px] overflow-hidden shadow-2xl border-8 border-transparent group-hover:border-primary/20 transition-all bg-gray-100">
                                                <img src={w.thumbnailUrl || w.thumbnail} referrerPolicy="no-referrer" className="w-full h-full object-cover" />
                                                <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-center pb-12"><span className="px-8 py-3 bg-white text-primary font-black rounded-full shadow-xl text-lg uppercase tracking-tighter italic">CHOOSE</span></div>
                                            </div>
                                            <h4 className="mt-8 text-xl font-black text-gray-800 tracking-tighter italic leading-tight max-w-[280px] mx-auto line-clamp-2">{w.titleName || w.title}</h4>
                                            <p className="mt-2 text-primary font-black text-[12px] opacity-0 group-hover:opacity-100 transition-all uppercase tracking-widest">{w.author}</p>
                                        </div>
                                    ))}
                                    <div className="absolute text-5xl font-black text-primary/10 italic select-none hidden md:block">VS</div>
                                </div>
                            </div>
                        )}

                        {stage === 'result' && finalWinner && (
                            <div className="text-center py-10">
                                <div className="mb-6"><span className="px-6 py-2 bg-yellow-400 text-white text-sm font-black rounded-full shadow-md uppercase tracking-widest italic">{t.worldcup_winner}</span></div>
                                <div className="mb-10 transform scale-110">
                                    <div className="relative w-64 sm:w-80 aspect-[3/4] mx-auto rounded-[64px] overflow-hidden shadow-[0_40px_80px_-20px_rgba(0,0,0,0.4)] border-[12px] border-yellow-400/20 bg-gray-100">
                                        <img src={finalWinner.thumbnailUrl || finalWinner.thumbnail} referrerPolicy="no-referrer" className="w-full h-full object-cover" />
                                        <div className="absolute top-6 right-6 w-16 h-16 bg-yellow-400 rounded-full flex items-center justify-center shadow-xl animate-bounce"><span className="text-3xl">ğŸ†</span></div>
                                    </div>
                                    <h4 className="mt-12 text-3xl font-black text-gray-900 tracking-tighter italic leading-tight">{finalWinner.titleName || finalWinner.title}</h4>
                                    <p className="mt-3 text-gray-400 font-bold uppercase tracking-widest">{finalWinner.author}</p>
                                </div>
                                <div className="flex gap-4 justify-center">
                                    <button onClick={() => setStage('select')} className="px-10 py-5 bg-gray-50 text-gray-500 font-black rounded-full hover:bg-gray-100 transition-all uppercase tracking-widest text-sm">{t.retry}</button>
                                    <a href={`https://comic.naver.com/webtoon/list?titleId=${finalWinner.titleId || finalWinner.id}`} target="_blank" className="px-12 py-5 bg-primary text-white font-black rounded-full shadow-xl hover:scale-105 active:scale-95 transition-all uppercase tracking-widest text-sm italic">{t.view_now}</a>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );

            if (isViewMode) return content;

            return (
                <div className="modal-container" onClick={onClose}>
                    <div className="modal-content-box" onClick={e => e.stopPropagation()}>
                        {content}
                    </div>
                </div>
            );
        };

        const App = () => {
            const supabase = supabaseInstance;
            const [lang, setLang] = useState('ko');
            const [view, setView] = useState('home'); // 'home', 'recommend', 'worldcup', 'search'
            const [step, setStep] = useState(1);
            const [searchQuery, setSearchQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [selectedG, setSelectedG] = useState([]);
            const [excludedG, setExcludedG] = useState([]); // Non-preferred tastes
            const [favTitle, setFavTitle] = useState("");
            const [loading, setLoading] = useState(false);
            const [results, setResults] = useState([]);
            const [scoredPool, setScoredPool] = useState([]);
            const [dislikedIds, setDislikedIds] = useState(() => {
                try { return JSON.parse(localStorage.getItem('excludedWebtoons')) || []; } catch (e) { return []; }
            });
            const [likedIds, setLikedIds] = useState([]);
            const [excludedFromRecoIds, setExcludedFromRecoIds] = useState([]);
            const [user, setUser] = useState(null);
            const [showAuthModal, setShowAuthModal] = useState(false);
            const [authMode, setAuthMode] = useState('login');
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [confirmPassword, setConfirmPassword] = useState('');
            const [showProfileModal, setShowProfileModal] = useState(false);
            const [profileTab, setProfileTab] = useState('liked');
            const [worldcupHistory, setWorldcupHistory] = useState([]);
            const [showWorldcupModal, setShowWorldcupModal] = useState(false);
            const [showShareModal, setShowShareModal] = useState(false);
            const [conflictTag, setConflictTag] = useState(null);
            const [showExcludePopup, setShowExcludePopup] = useState(false);
            const [showHelpModal, setShowHelpModal] = useState(false);
            const [todayVisitors, setTodayVisitors] = useState(0);
            const [totalVisitors, setTotalVisitors] = useState(0);

            // Compute Top 5 Lists for Genres
            const { topWebtoons, fantasyTop, romanceTop, martialTop, sliceTop } = useMemo(() => {
                const rawData = window.WEBTOON_DATA || MOCK_WEBTOONS;
                const sorted = [...rawData].sort((a, b) => (b.starScore || 0) - (a.starScore || 0));

                const getTopByGenre = (genreKeyword) => {
                    return sorted
                        .filter(w => (w.tags || []).some(t => t.includes(genreKeyword)))
                        .slice(0, 5)
                        .map(item => ({
                            id: item.titleId || item.id,
                            title: item.titleName || item.title,
                            thumbnail: item.thumbnailUrl || item.thumbnail,
                            tags: item.tags || [item.author],
                            status: item.status,
                            author: item.author,
                            starScore: item.starScore
                        }));
                };

                return {
                    topWebtoons: sorted.slice(0, 5).map(item => ({
                        id: item.titleId || item.id,
                        title: item.titleName || item.title,
                        thumbnail: item.thumbnailUrl || item.thumbnail,
                        tags: item.tags || [item.author],
                        status: item.status,
                        author: item.author,
                        starScore: item.starScore
                    })),
                    fantasyTop: getTopByGenre('íŒíƒ€ì§€'),
                    romanceTop: getTopByGenre('ë¡œë§¨ìŠ¤'),
                    martialTop: getTopByGenre('ë¬´í˜‘'), // 'ë¬´í˜‘/ì‚¬ê·¹' usually
                    sliceTop: getTopByGenre('ì¼ìƒ')
                };
            }, []);

            const handleSearch = (q) => {
                setSearchQuery(q);
                if (!q.trim()) {
                    setSearchResults([]);
                    if (view === 'search') setView('home');
                    return;
                }
                const rawData = window.WEBTOON_DATA || MOCK_WEBTOONS;
                const filtered = rawData.filter(w =>
                    (w.titleName || w.title).toLowerCase().includes(q.toLowerCase()) ||
                    (w.author || '').toLowerCase().includes(q.toLowerCase()) ||
                    (w.tags || []).some(t => t.toLowerCase().includes(q.toLowerCase()))
                ).map(item => ({
                    id: item.titleId || item.id,
                    title: item.titleName || item.title,
                    thumbnail: item.thumbnailUrl || item.thumbnail,
                    tags: (item.tags && item.tags.length > 0) ? item.tags : [item.author],
                    status: item.status,
                    author: item.author,
                    starScore: item.starScore
                }));
                setSearchResults(filtered);
                setView('search');
            };

            const t = TRANSLATIONS[lang] || TRANSLATIONS.ko;

            useEffect(() => {
                supabase.auth.getSession().then(({ data: { session } }) => {
                    if (session) { setUser(session.user); loadUserData(session.user.id); }
                });
                const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
                    if (session) { setUser(session.user); loadUserData(session.user.id); }
                    else { setUser(null); setLikedIds([]); setDislikedIds([]); }
                });

                // Handle Signup Success Redirect
                if (window.location.hash.includes('type=signup')) {
                    alert(t.signup_success);
                    // Clear hash to avoid repeated alerts
                    window.history.replaceState(null, null, window.location.pathname);
                }

                return () => subscription.unsubscribe();
            }, [t]);

            // Visitor Counter Effect
            useEffect(() => {
                const trackVisitor = async () => {
                    const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD
                    const visitorKey = `visited_${today}`;

                    // Check if already visited today
                    if (!localStorage.getItem(visitorKey)) {
                        localStorage.setItem(visitorKey, 'true');

                        // Increment visitor count in Supabase
                        await supabaseClient.rpc('increment_visitor', { visit_date: today });
                    }

                    // Fetch visitor counts
                    const { data: todayData } = await supabase
                        .from('visitor_stats')
                        .select('count')
                        .eq('date', today)
                        .single();

                    const { data: totalData } = await supabase
                        .from('visitor_stats')
                        .select('count');

                    if (todayData) setTodayVisitors(todayData.count || 0);
                    if (totalData) setTotalVisitors(totalData.reduce((sum, row) => sum + (row.count || 0), 0));
                };

                trackVisitor();
            }, []);

            const loadUserData = async (userId) => {
                const { data: exData } = await supabaseClient.from('excluded_webtoons').select('webtoon_id').eq('user_id', userId);
                if (exData) setDislikedIds(exData.map(d => d.webtoon_id));
                const { data: favData } = await supabaseClient.from('favorite_webtoons').select('webtoon_id').eq('user_id', userId);
                if (favData) setLikedIds(favData.map(d => d.webtoon_id));

                // Load worldcup history
                const { data: wcData } = await supabaseClient.from('worldcup_results').select('*').eq('user_id', userId).order('created_at', { ascending: false });
                if (wcData) setWorldcupHistory(wcData);

                // Load excluded from recommendations
                const { data: exRecoData } = await supabaseClient.from('excluded_from_recommendations').select('webtoon_id').eq('user_id', userId);
                if (exRecoData) setExcludedFromRecoIds(exRecoData.map(d => d.webtoon_id));
            };

            const toggleLike = async (id) => {
                if (!user) { setShowAuthModal(true); return; }
                const isLiked = likedIds.includes(id);
                if (isLiked) {
                    await supabaseClient.from('favorite_webtoons').delete().eq('user_id', user.id).eq('webtoon_id', id);
                    setLikedIds(prev => prev.filter(it => it !== id));
                } else {
                    // Remove from dislikes if it was disliked
                    if (dislikedIds.includes(id)) toggleDislike(id);
                    await supabaseClient.from('favorite_webtoons').insert({ user_id: user.id, webtoon_id: id });
                    setLikedIds(prev => [...prev, id]);
                }
            };

            const handleExclude = async (id) => {
                const newEx = [...dislikedIds, id];
                setDislikedIds(newEx);
                localStorage.setItem('excludedWebtoons', JSON.stringify(newEx));
                if (user) { await supabaseClient.from('excluded_webtoons').upsert({ user_id: user.id, webtoon_id: id }); }
                setResults(scoredPool.filter(x => !newEx.includes(x.id)).slice(0, 10));
                setShowExcludePopup(true);
                setTimeout(() => setShowExcludePopup(false), 2000);
            };
            const categories = useMemo(() => getGenreCategories(t), [t]);

            const nextStep = () => { setStep(prev => prev + 1); window.scrollTo({ top: 0, behavior: 'smooth' }); };
            const prevStep = () => { setStep(prev => prev - 1); window.scrollTo({ top: 0, behavior: 'smooth' }); };
            const reset = () => { setStep(1); setSelectedG([]); setExcludedG([]); setFavTitle(""); setScoredPool([]); window.scrollTo({ top: 0, behavior: 'smooth' }); };

            const handleAnalyze = async () => {
                setLoading(true); setStep(4);
                window.scrollTo({ top: 0, behavior: 'smooth' });
                await new Promise(r => setTimeout(r, 1500));
                const rawData = window.WEBTOON_DATA || MOCK_WEBTOONS;
                const statusFilters = selectedG.filter(s => ["ì—°ì¬ì¤‘", "ì™„ê²°"].includes(s));
                const genrePreferences = selectedG.filter(s => !["ì—°ì¬ì¤‘", "ì™„ê²°"].includes(s));

                // Similarity scoring based on liked webtoons
                const likedWebtoons = rawData.filter(w => likedIds.includes(w.titleId || w.id));
                const preferredLegacyTags = likedWebtoons.reduce((acc, curr) => [...acc, ...(curr.tags || [])], []);

                // Get worldcup winners for bonus scoring
                const worldcupWinnerIds = worldcupHistory.map(h => h.winner_id);

                const scoredData = rawData.map(item => {
                    const webtoon = {
                        id: item.titleId || item.id,
                        title: item.titleName || item.title,
                        thumbnail: item.thumbnailUrl || item.thumbnail,
                        tags: (item.tags && item.tags.length > 0) ? item.tags : [item.day, item.status === 'FINISHED' ? t.finished : t.ongoing, item.author].filter(Boolean),
                        author: item.author,
                        status: item.status,
                        starScore: item.starScore || 0,
                        viewCount: item.viewCount || 0
                    };

                    if (dislikedIds.includes(webtoon.id)) return { ...webtoon, match: 0 };

                    let score = 50;
                    if (statusFilters.length > 0) {
                        const myStatus = webtoon.status === 'FINISHED' ? 'ì™„ê²°' : 'ì—°ì¬ì¤‘';
                        if (!statusFilters.includes(myStatus)) return { ...webtoon, match: 0 };
                    }

                    // í™•ì¥ëœ ì¥ë¥´ ë§¤ì¹­ (ìœ ì‚¬ ì¥ë¥´ í¬í•¨)
                    const expandedPrefs = expandGenres(genrePreferences);
                    const expandedExcluded = expandGenres(excludedG);

                    // ë¹„ì„ í˜¸ ì¥ë¥´ ì²´í¬ (í™•ì¥ëœ í‚¤ì›Œë“œ ì ìš©)
                    if (expandedExcluded.length > 0) {
                        const hasExcludedTag = expandedExcluded.some(ex =>
                            webtoon.tags.some(t => String(t).toLowerCase().includes(ex.toLowerCase())) ||
                            webtoon.title.toLowerCase().includes(ex.toLowerCase())
                        );
                        if (hasExcludedTag) return { ...webtoon, match: 0 };
                    }

                    // ì„ í˜¸ ì¥ë¥´ ì ìˆ˜ ê³„ì‚° (í™•ì¥ëœ í‚¤ì›Œë“œ ì ìš©)
                    expandedPrefs.forEach(pref => {
                        if (webtoon.tags.some(t => String(t).toLowerCase().includes(pref.toLowerCase())) ||
                            webtoon.title.toLowerCase().includes(pref.toLowerCase())) {
                            score += 15; // ìœ ì‚¬ ì¥ë¥´ëŠ” ì•½ê°„ ë‚®ì€ ì ìˆ˜
                        }
                    });

                    // ì›ë³¸ ì„ í˜¸ ì¥ë¥´ëŠ” ì¶”ê°€ ë³´ë„ˆìŠ¤
                    genrePreferences.forEach(pref => {
                        const keywords = pref.includes('/') ? pref.split('/') : [pref];
                        if (keywords.some(k => webtoon.tags.some(t => String(t).includes(k)) || webtoon.title.includes(k))) {
                            score += 10; // ì›ë³¸ ë§¤ì¹­ ë³´ë„ˆìŠ¤
                        }
                    });

                    // Bonus for similarity to liked webtoons
                    if (preferredLegacyTags.length > 0) {
                        const overlap = webtoon.tags.filter(tag => preferredLegacyTags.includes(tag)).length;
                        score += (overlap * 5);
                    }

                    // Bonus for worldcup winners
                    if (worldcupWinnerIds.includes(webtoon.id)) {
                        score += 15;
                    }

                    return { ...webtoon, match: Math.min(99, score + (Math.random() * 5)) };
                });

                const sorted = scoredData.filter(w => w.match > 0 && !excludedFromRecoIds.includes(w.id)).sort((a, b) => {
                    let scoreA = a.match;
                    let scoreB = b.match;
                    if (dislikedIds.includes(a.id)) scoreA -= 50;
                    if (dislikedIds.includes(b.id)) scoreB -= 50;
                    if (scoreB !== scoreA) return scoreB - scoreA;
                    if (b.starScore !== a.starScore) return b.starScore - a.starScore;
                    return b.viewCount - a.viewCount;
                });
                setScoredPool(sorted);
                setResults(sorted.slice(0, 10));
                setLoading(false);
            };

            const toggleDislike = async (id) => {
                if (!user) { setShowAuthModal(true); return; }
                const isDisliked = dislikedIds.includes(id);
                if (isDisliked) {
                    await supabaseClient.from('excluded_webtoons').delete().eq('user_id', user.id).eq('webtoon_id', id);
                    const newDislikedIds = dislikedIds.filter(it => it !== id);
                    setDislikedIds(newDislikedIds);
                    localStorage.setItem('excludedWebtoons', JSON.stringify(newDislikedIds));
                } else {
                    // Remove from likes if it was liked
                    if (likedIds.includes(id)) toggleLike(id);
                    await supabaseClient.from('excluded_webtoons').insert({ user_id: user.id, webtoon_id: id });
                    const newDislikedIds = [...dislikedIds, id];
                    setDislikedIds(newDislikedIds);
                    localStorage.setItem('excludedWebtoons', JSON.stringify(newDislikedIds));
                }
            };

            // ì¶”ì²œ ê²°ê³¼ì—ì„œë§Œ ì œì™¸ (ì„ í˜¸ì— ì˜í–¥ ì—†ìŒ)
            const excludeFromResult = (id) => {
                // í˜„ì¬ ê²°ê³¼ì—ì„œ ì œì™¸í•˜ê³ , scoredPoolì—ì„œ ë‹¤ìŒ ì› íˆ° ê°€ì ¸ì˜¤ê¸°
                const currentResultIds = results.map(r => r.id);
                const remainingPool = scoredPool.filter(w => !currentResultIds.includes(w.id) || w.id === id);
                const newResults = results.filter(r => r.id !== id);

                // ë‹¤ìŒ ìˆœìœ„ ì› íˆ° ì¶”ê°€ (í˜„ì¬ 10ê°œ ë¯¸ë§Œì´ë©´)
                if (newResults.length < 10 && remainingPool.length > 0) {
                    const nextInPool = scoredPool.find(w => !newResults.some(r => r.id === w.id) && w.id !== id);
                    if (nextInPool) {
                        newResults.push(nextInPool);
                    }
                }

                setResults(newResults);

                // íŒì—… í‘œì‹œ
                setShowExcludePopup(true);
                setTimeout(() => setShowExcludePopup(false), 2000);
            };

            return (
                <div className="min-h-screen">
                    <header className="!bg-white shadow-[0_1px_0_0_rgba(0,0,0,0.08)] sticky top-0 z-[100000]">
                        <div className="max-w-[1500px] mx-auto px-6 h-16 flex items-center justify-between gap-8">
                            {/* Left: Brand & Nav */}
                            <div className="flex items-center gap-8 flex-shrink-0">
                                <button onClick={() => setView('home')} className="flex items-center gap-1 group">
                                    <span className="text-xl font-black text-[#00DC64] tracking-tighter italic group-hover:scale-105 transition-transform">Nì›¹íˆ°</span>
                                    <span className="text-xl font-black text-gray-900 tracking-tighter italic group-hover:scale-105 transition-transform">íŒŒì¸ë”</span>
                                </button>
                                <nav className="hidden md:flex items-center gap-6">
                                    <button onClick={() => setView('home')} className={`text-sm font-bold transition-colors ${view === 'home' ? 'text-gray-900' : 'text-gray-400 hover:text-gray-600'}`}>{lang === 'ko' ? 'í™ˆ' : 'Home'}</button>
                                    <button onClick={() => { setView('recommend'); setStep(1); }} className={`text-sm font-bold transition-colors ${view === 'recommend' ? 'text-gray-900' : 'text-gray-400 hover:text-gray-600'}`}>{lang === 'ko' ? 'ì¶”ì²œë°›ê¸°' : 'Recommend'}</button>
                                    <button onClick={() => {
                                        setView('worldcup');
                                        if (!user) alert(lang === 'ko' ? "ë¡œê·¸ì¸ ì‹œ ë‚´ ì·¨í–¥ì— ë°˜ì˜ë©ë‹ˆë‹¤!" : "Login to reflect in your preferences!");
                                    }} className={`text-sm font-bold transition-colors ${view === 'worldcup' ? 'text-gray-900' : 'text-gray-400 hover:text-gray-600'}`}>{lang === 'ko' ? 'ì›¹íˆ°ì›”ë“œì»µ' : 'World Cup'}</button>
                                    <button onClick={() => setShowHelpModal(true)} className="text-sm font-bold text-gray-400 hover:text-gray-600 transition-colors">ë„ì›€ë§</button>
                                </nav>
                            </div>

                            {/* Center: Search */}
                            <div className="flex-grow max-w-xl relative">
                                <div className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
                                    <svg viewBox="0 0 24 24" className="w-4 h-4 fill-current"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
                                </div>
                                <input
                                    type="text"
                                    value={searchQuery}
                                    onChange={(e) => handleSearch(e.target.value)}
                                    placeholder={lang === 'ko' ? 'ì‘ê°€, ì¥ë¥´, í‚¤ì›Œë“œ ë“±ì„ ì…ë ¥í•´ë³´ì„¸ìš”' : 'Search titles, authors, keywords'}
                                    className="w-full bg-gray-100 rounded-lg py-2 pl-12 pr-4 text-sm font-medium outline-none focus:bg-gray-200 transition-all border border-transparent focus:border-gray-300"
                                />
                            </div>

                            {/* Right: Actions */}
                            <div className="flex items-center gap-4 flex-shrink-0">
                                <div className="flex items-center gap-1 scale-90 border-r border-gray-100 pr-4 mr-2">
                                    {[{ code: 'ko', label: 'KO' }, { code: 'en', label: 'EN' }, { code: 'zh', label: 'ZH' }, { code: 'ja', label: 'JA' }].map(l => (
                                        <button key={l.code} onClick={() => setLang(l.code)}
                                            className={`px-2 py-1 rounded-md border text-[9px] font-black transition-all ${lang === l.code ? 'bg-primary border-primary text-white shadow-sm' : 'bg-white text-gray-300 border-gray-100'}`}>
                                            {l.label}
                                        </button>
                                    ))}
                                </div>
                                {user ? (
                                    <div className="flex items-center gap-4">
                                        <button onClick={() => setShowProfileModal(true)} className="text-sm font-bold text-gray-500 hover:text-gray-900">{lang === 'ko' ? 'ë‚´ ì •ë³´' : 'Profile'}</button>
                                        <button onClick={() => supabase.auth.signOut()} className="text-sm font-bold text-gray-400 hover:text-red-500">{lang === 'ko' ? 'ë¡œê·¸ì•„ì›ƒ' : 'Logout'}</button>
                                    </div>
                                ) : (
                                    <div className="flex items-center gap-2">
                                        <button onClick={() => { setShowAuthModal(true); setAuthMode('login'); }} className="text-xs font-black bg-black text-white px-4 py-2 rounded-full hover:scale-105 transition-transform">{lang === 'ko' ? 'ë¡œê·¸ì¸' : 'Log In'}</button>
                                        <button onClick={() => { setShowAuthModal(true); setAuthMode('signup'); email && setAuthMode('signup'); }} className="text-xs font-black bg-[#00DC64] text-white px-4 py-2 rounded-full hover:scale-105 transition-transform">{lang === 'ko' ? 'íšŒì›ê°€ì…' : 'Sign Up'}</button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </header>
                    <main className="max-w-[1500px] mx-auto px-10 py-10">
                        {view === 'home' && (
                            <div className="animate-up space-y-16">
                                <div className="">
                                    <h2 className="text-xl font-black mb-6 text-gray-900 border-l-4 border-[#00DC64] pl-3">{lang === 'ko' ? 'ë„¤ì´ë²„ ì›¹íˆ° ë³„ì  Top 5' : 'Naver Webtoon Top 5'}</h2>
                                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                                        {topWebtoons.map((w, idx) => (
                                            <WebtoonCard key={w.id} item={w} rank={idx + 1} onDislike={toggleDislike} onLike={toggleLike} onExcludeFromResult={excludeFromResult} isLiked={likedIds.includes(w.id)} isDisliked={dislikedIds.includes(w.id)} t={t} />
                                        ))}
                                    </div>
                                </div>

                                <div className="">
                                    <h2 className="text-xl font-black mb-6 text-gray-900 border-l-4 border-purple-500 pl-3">ğŸ”® {lang === 'ko' ? 'íŒíƒ€ì§€ Top 5' : 'Fantasy Top 5'}</h2>
                                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                                        {fantasyTop.map((w, idx) => (<WebtoonCard key={w.id} item={w} rank={idx + 1} onDislike={toggleDislike} onLike={toggleLike} onExcludeFromResult={excludeFromResult} isLiked={likedIds.includes(w.id)} isDisliked={dislikedIds.includes(w.id)} t={t} />))}
                                    </div>
                                </div>

                                <div className="">
                                    <h2 className="text-xl font-black mb-6 text-gray-900 border-l-4 border-pink-500 pl-3">ğŸ’– {lang === 'ko' ? 'ë¡œë§¨ìŠ¤ Top 5' : 'Romance Top 5'}</h2>
                                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                                        {romanceTop.map((w, idx) => (<WebtoonCard key={w.id} item={w} rank={idx + 1} onDislike={toggleDislike} onLike={toggleLike} onExcludeFromResult={excludeFromResult} isLiked={likedIds.includes(w.id)} isDisliked={dislikedIds.includes(w.id)} t={t} />))}
                                    </div>
                                </div>

                                <div className="">
                                    <h2 className="text-xl font-black mb-6 text-gray-900 border-l-4 border-orange-500 pl-3">âš”ï¸ {lang === 'ko' ? 'ë¬´í˜‘/ì‚¬ê·¹ Top 5' : 'Martial Arts Top 5'}</h2>
                                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                                        {martialTop.map((w, idx) => (<WebtoonCard key={w.id} item={w} rank={idx + 1} onDislike={toggleDislike} onLike={toggleLike} onExcludeFromResult={excludeFromResult} isLiked={likedIds.includes(w.id)} isDisliked={dislikedIds.includes(w.id)} t={t} />))}
                                    </div>
                                </div>

                                <div className="">
                                    <h2 className="text-xl font-black mb-6 text-gray-900 border-l-4 border-yellow-500 pl-3">ğŸŒ± {lang === 'ko' ? 'ì¼ìƒ Top 5' : 'Slice of Life Top 5'}</h2>
                                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                                        {sliceTop.map((w, idx) => (<WebtoonCard key={w.id} item={w} rank={idx + 1} onDislike={toggleDislike} onLike={toggleLike} onExcludeFromResult={excludeFromResult} isLiked={likedIds.includes(w.id)} isDisliked={dislikedIds.includes(w.id)} t={t} />))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'search' && (
                            <div className="animate-up">
                                <div className="mb-10">
                                    <h2 className="text-xl font-black mb-6 text-gray-900">{lang === 'ko' ? `'${searchQuery}' ê²€ìƒ‰ ê²°ê³¼` : `Search results for '${searchQuery}'`}</h2>
                                    {searchResults.length === 0 ? (
                                        <div className="py-20 text-center text-gray-300 font-bold">{t.no_data || 'No results found.'}</div>
                                    ) : (
                                        <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                                            {searchResults.map((w, idx) => (
                                                <WebtoonCard key={w.id} item={w} rank={0} onDislike={toggleDislike} onLike={toggleLike} onExcludeFromResult={excludeFromResult} isLiked={likedIds.includes(w.id)} isDisliked={dislikedIds.includes(w.id)} t={t} />
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {view === 'worldcup' && (
                            <div className="animate-up">
                                <div className="max-w-4xl mx-auto py-10">
                                    <WorldcupModal
                                        isOpen={true}
                                        onClose={() => setView('home')}
                                        t={t}
                                        user={user}
                                        onSaveResult={(result) => setWorldcupHistory(prev => [result, ...prev])}
                                        isViewMode={true}
                                    />
                                </div>
                            </div>
                        )}

                        {view === 'recommend' && (
                            <>
                                <ProgressBar step={step} t={t} />
                                {step === 1 && (
                                    <div className="animate-up max-w-4xl mx-auto">
                                        <div className="text-center mb-14"><h2 className="text-3xl sm:text-4xl font-black mb-4 tracking-tight">{t.step1_title}</h2><p className="text-gray-600 italic font-bold">{t.step1_desc}</p></div>
                                        <div className="space-y-10">{categories.map(cat => (<div key={cat.name} className="space-y-5"><h3 className="text-sm font-black text-gray-600 uppercase tracking-widest px-1">{cat.name}</h3><div className="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 gap-3">{cat.genres.map((g, idx) => { const label = lang === 'en' ? cat.en[idx] : lang === 'zh' ? cat.zh[idx] : lang === 'ja' ? cat.ja[idx] : g; return (<button key={g} onClick={() => setSelectedG(prev => prev.includes(g) ? prev.filter(it => it !== g) : [...prev, g])} className={`py-4 px-4 rounded-[24px] text-[13px] font-bold border-2 transition-all ${selectedG.includes(g) ? 'bg-primary border-primary text-white shadow-xl scale-[0.98]' : 'bg-white border-gray-100 text-gray-500'}`}>#{label}</button>); })}</div></div>))}</div>
                                        <div className="mt-20 text-center"><button disabled={selectedG.length === 0} onClick={nextStep} className="w-full sm:w-auto px-16 py-5 bg-primary text-white font-black rounded-full shadow-2xl disabled:opacity-20 text-lg uppercase tracking-widest">NEXT</button></div>
                                    </div>
                                )}
                                {step === 2 && (
                                    <div className="animate-up max-w-4xl mx-auto">
                                        <div className="text-center mb-14"><h2 className="text-3xl sm:text-4xl font-black mb-4 tracking-tight">{t.step2_title}</h2><p className="text-gray-600 italic font-bold">{t.step2_desc}</p></div>
                                        <div className="space-y-10">
                                            {categories.map(cat => (
                                                <div key={cat.name} className="space-y-5">
                                                    <h3 className="text-sm font-black text-gray-600 uppercase tracking-widest px-1">{cat.name}</h3>
                                                    <div className="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 gap-3">
                                                        {cat.genres.map((g, idx) => {
                                                            const label = lang === 'en' ? cat.en[idx] : lang === 'zh' ? cat.zh[idx] : lang === 'ja' ? cat.ja[idx] : g;
                                                            const isPreferred = selectedG.includes(g);
                                                            return (
                                                                <button
                                                                    key={g}
                                                                    onClick={() => {
                                                                        if (isPreferred) {
                                                                            setConflictTag(g);
                                                                        } else {
                                                                            setExcludedG(prev => prev.includes(g) ? prev.filter(it => it !== g) : [...prev, g]);
                                                                        }
                                                                    }}
                                                                    className={`py-4 px-4 rounded-[24px] text-[13px] font-bold border-2 transition-all ${excludedG.includes(g) ? 'bg-red-500 border-red-500 text-white shadow-xl scale-[0.98]' : isPreferred ? 'bg-gray-100 border-gray-100 text-gray-300' : 'bg-white border-gray-100 text-gray-500'}`}
                                                                >
                                                                    #{label}
                                                                </button>
                                                            );
                                                        })}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                        <div className="mt-20 flex gap-4 justify-center"><button onClick={prevStep} className="px-16 py-5 bg-gray-100 text-gray-500 font-bold rounded-full uppercase">BACK</button><button onClick={nextStep} className="px-16 py-5 bg-primary text-white font-black rounded-full shadow-2xl uppercase">CONTINUE</button></div>
                                    </div>
                                )}
                                {step === 3 && (
                                    <div className="animate-up max-w-2xl mx-auto py-10 px-6">
                                        <div className="text-center mb-12">
                                            <h2 className="text-3xl font-black mb-4 tracking-tight">{t.step3_title}</h2>
                                            <p className="text-gray-400 font-medium italic opacity-80 decoration-primary/30 decoration-2">{t.step3_desc || ""}</p>
                                        </div>
                                        <div className="space-y-8">
                                            <input
                                                type="text"
                                                value={favTitle}
                                                onChange={e => setFavTitle(e.target.value)}
                                                placeholder={t.step3_placeholder}
                                                className="w-full py-5 px-8 rounded-3xl bg-white border-2 border-gray-100 focus:border-primary focus:ring-4 focus:ring-primary/5 outline-none text-center text-lg shadow-sm transition-all font-bold placeholder:text-gray-200"
                                            />
                                            <div className="flex gap-3">
                                                <button onClick={prevStep} className="flex-1 py-4 bg-gray-50 text-gray-400 font-bold rounded-2xl hover:bg-gray-100 transition-all uppercase tracking-widest text-sm">BACK</button>
                                                <button
                                                    onClick={handleAnalyze}
                                                    className="flex-[2] py-4 bg-primary text-white font-black rounded-2xl shadow-xl hover:shadow-primary/20 hover:scale-[1.02] active:scale-95 transition-all uppercase tracking-widest"
                                                >
                                                    ANALYZE
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                )}
                                {step === 4 && (
                                    <div className="animate-up">{loading ? (<div className="flex flex-col items-center justify-center py-40"><div className="w-16 h-16 border-[8px] border-gray-100 border-t-primary rounded-full animate-spin mb-10"></div><p className="text-gray-300 font-black tracking-widest uppercase animate-pulse">{t.computing}</p></div>) : (<div className="animate-up max-w-[1400px] mx-auto pb-40 px-6"><div className="text-center mb-14"><h2 className="text-2xl sm:text-3xl font-black mb-3 italic tracking-tight">{t.result_title}</h2><p className="text-gray-400 font-medium text-sm">{t.result_desc}</p></div><div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">{results.map((w, idx) => (<WebtoonCard key={w.id} item={w} rank={idx + 1} onDislike={toggleDislike} onLike={toggleLike} onExcludeFromResult={excludeFromResult} isLiked={likedIds.includes(w.id)} isDisliked={dislikedIds.includes(w.id)} t={t} />))}</div><button onClick={reset} className="mt-20 px-12 py-5 border-2 border-gray-200 text-gray-300 font-black rounded-full hover:border-primary hover:text-primary transition-all uppercase block mx-auto tracking-widest text-sm">NEW SEARCH</button></div>)}</div>
                                )}
                            </>
                        )}
                    </main>
                    {showExcludePopup && (<div className="fixed bottom-10 left-1/2 -translate-x-1/2 z-[1000] animate-up"><div className="bg-gray-900/95 backdrop-blur-md text-white px-8 py-4 rounded-3xl shadow-2xl flex items-center gap-3"><span className="text-2xl">ğŸš«</span><p className="font-bold text-sm tracking-tight">{t.exclude_msg}</p></div></div>)}

                    {/* Conflict Confirmation Modal */}
                    {
                        conflictTag && (
                            <div className="modal-container" onClick={() => setConflictTag(null)}>
                                <div className="modal-content-box" onClick={e => e.stopPropagation()}>
                                    <div className="bg-white w-full max-w-xs rounded-[40px] shadow-2xl p-8 text-center animate-up">
                                        <span className="text-3xl mb-4 block">âš ï¸</span>
                                        <p className="text-gray-800 font-bold text-sm leading-relaxed mb-8 whitespace-pre-wrap">{t.conflict_msg}</p>
                                        <div className="flex gap-3">
                                            <button
                                                onClick={() => {
                                                    setSelectedG(prev => prev.filter(it => it !== conflictTag));
                                                    setExcludedG(prev => [...prev, conflictTag]);
                                                    setConflictTag(null);
                                                }}
                                                className="flex-1 py-4 bg-primary text-white font-black rounded-2xl shadow-lg active:scale-95 transition-transform"
                                            >
                                                {t.yes}
                                            </button>
                                            <button
                                                onClick={() => setConflictTag(null)}
                                                className="flex-1 py-4 bg-gray-100 text-gray-500 font-bold rounded-2xl active:scale-95 transition-transform"
                                            >
                                                {t.no}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )
                    }

                    <ShareModal isOpen={showShareModal} onClose={() => setShowShareModal(false)} t={t} results={profileTab === 'liked' ? likedIds.map(id => (window.WEBTOON_DATA || MOCK_WEBTOONS).find(w => (w.titleId || w.id) == id)).filter(Boolean) : results} />
                    <HelpModal isOpen={showHelpModal} onClose={() => setShowHelpModal(false)} t={t} />

                    {
                        showWorldcupModal && (
                            <div className="modal-container" onClick={() => setShowWorldcupModal(false)}>
                                <div className="modal-content-box" onClick={e => e.stopPropagation()}>
                                    <WorldcupModal
                                        isOpen={showWorldcupModal}
                                        onClose={() => setShowWorldcupModal(false)}
                                        t={t}
                                        user={user}
                                        onSaveResult={(result) => setWorldcupHistory(prev => [result, ...prev])}
                                    />
                                </div>
                            </div>
                        )
                    }

                    {/* Authentication Modal */}
                    {/* Authentication Modal */}
                    {
                        showAuthModal && (
                            <div className="modal-container" onClick={() => { setShowAuthModal(false); setAuthMode('login'); setEmail(''); setPassword(''); setConfirmPassword(''); }}>
                                <div className="modal-content-box" onClick={e => e.stopPropagation()}>
                                    <div className="bg-white w-full max-w-sm rounded-[48px] shadow-2xl p-10 flex flex-col items-center">
                                        <h3 className="text-2xl font-black mb-8 tracking-tighter">{authMode === 'login' ? t.login : t.signup_btn}</h3>
                                        <div className="w-full space-y-4">
                                            <div className="flex flex-col gap-3">
                                                <input
                                                    type="email"
                                                    value={email}
                                                    onChange={e => setEmail(e.target.value)}
                                                    placeholder={t.email}
                                                    className="px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 outline-none focus:border-primary font-bold text-sm"
                                                />
                                                <input
                                                    type="password"
                                                    value={password}
                                                    onChange={e => setPassword(e.target.value)}
                                                    placeholder={t.password}
                                                    className="px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 outline-none focus:border-primary font-bold text-sm"
                                                />
                                                {authMode === 'signup' && (
                                                    <>
                                                        <input
                                                            type="password"
                                                            value={confirmPassword}
                                                            onChange={e => setConfirmPassword(e.target.value)}
                                                            placeholder={t.password_confirm}
                                                            className="px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 outline-none focus:border-primary font-bold text-sm"
                                                        />
                                                        {password && password.length < 6 && <p className="text-[10px] font-bold text-red-500 px-2">{t.pw_criteria}</p>}
                                                        {confirmPassword && password !== confirmPassword && <p className="text-[10px] font-bold text-red-500 px-2">{t.pw_mismatch}</p>}
                                                    </>
                                                )}
                                            </div>

                                            {authMode === 'login' ? (
                                                <div className="flex flex-col gap-4">
                                                    <button
                                                        onClick={async () => {
                                                            const { error } = await supabaseClient.auth.signInWithPassword({ email, password });
                                                            if (error) alert(t.login_error_msg || error.message); else setShowAuthModal(false);
                                                        }}
                                                        className="w-full py-4 bg-primary text-white font-black rounded-2xl shadow-lg active:scale-95 transition-transform"
                                                    >
                                                        {t.login_btn}
                                                    </button>
                                                    <button
                                                        onClick={() => setAuthMode('signup')}
                                                        className="text-center text-[11px] font-bold text-gray-400 hover:text-primary transition-colors"
                                                    >
                                                        {t.go_to_signup}
                                                    </button>
                                                    <button
                                                        onClick={async () => {
                                                            if (!email) { alert("Please enter your email first"); return; }
                                                            const { error } = await supabaseClient.auth.resetPasswordForEmail(email);
                                                            if (error) alert(error.message); else alert(t.reset_pw_msg);
                                                        }}
                                                        className="w-full text-center text-[11px] font-bold text-gray-400 hover:text-primary transition-colors pt-2 border-t border-gray-50 mt-2"
                                                    >
                                                        {t.find_pw}
                                                    </button>
                                                </div>
                                            ) : (
                                                <div className="flex flex-col gap-4">
                                                    <button
                                                        disabled={!email || password.length < 6 || password !== confirmPassword}
                                                        onClick={async () => {
                                                            const { error } = await supabaseClient.auth.signUp({ email, password });
                                                            if (error) alert(error.message);
                                                            else {
                                                                alert(t.signup_confirm_msg);
                                                                setAuthMode('login');
                                                            }
                                                        }}
                                                        className="w-full py-4 bg-primary text-white font-black rounded-2xl shadow-lg active:scale-95 transition-transform disabled:opacity-30 disabled:pointer-events-none"
                                                    >
                                                        {t.signup_btn}
                                                    </button>
                                                    <button
                                                        onClick={() => setAuthMode('login')}
                                                        className="text-center text-[11px] font-bold text-gray-400 hover:text-primary transition-colors"
                                                    >
                                                        {t.go_to_login}
                                                    </button>
                                                </div>
                                            )}
                                        </div>
                                        <button
                                            onClick={() => { setShowAuthModal(false); setAuthMode('login'); setEmail(''); setPassword(''); setConfirmPassword(''); }}
                                            className="mt-8 text-gray-400 font-bold text-xs uppercase"
                                        >
                                            CLOSE
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )
                    }

                    {/* My Info Modal */}
                    {
                        showProfileModal && (
                            <div className="modal-container" onClick={() => setShowProfileModal(false)}>
                                <div className="modal-content-box" onClick={e => e.stopPropagation()}>
                                    <div className="bg-white w-full max-w-2xl rounded-[48px] shadow-2xl flex flex-col h-[80vh]">
                                        <div className="p-10 pb-6 flex flex-col items-center flex-shrink-0">
                                            <h3 className="text-2xl font-black mb-6 tracking-tighter">{t.my_info}</h3>
                                            <div className="flex gap-2 p-1.5 bg-gray-100 rounded-2xl w-full">
                                                <button onClick={() => setProfileTab('liked')} className={`flex-1 py-3 px-4 rounded-xl font-bold text-sm transition-all ${profileTab === 'liked' ? 'bg-white text-primary shadow-sm' : 'text-gray-400 hover:text-gray-600'}`}>ğŸ“š {lang === 'ko' ? 'ë‚˜ì˜ ì»¬ë ‰ì…˜' : 'My Collection'}</button>
                                                <button onClick={() => setProfileTab('excluded')} className={`flex-1 py-3 px-4 rounded-xl font-bold text-sm transition-all ${profileTab === 'excluded' ? 'bg-white text-red-500 shadow-sm' : 'text-gray-400 hover:text-gray-600'}`}>{t.excluded_list}</button>
                                                <button onClick={() => setProfileTab('worldcup')} className={`flex-1 py-3 px-4 rounded-xl font-bold text-sm transition-all ${profileTab === 'worldcup' ? 'bg-white text-yellow-600 shadow-sm' : 'text-gray-400 hover:text-gray-600'}`}>ğŸ† {t.worldcup_history}</button>
                                            </div>
                                        </div>
                                        <div className="flex-grow overflow-y-auto px-10 no-scrollbar">
                                            {profileTab === 'liked' && (
                                                <div className="mb-6">
                                                    <button onClick={() => setShowShareModal(true)} className="w-full py-4 bg-primary/10 text-primary font-black rounded-2xl hover:bg-primary/20 transition-all flex items-center justify-center gap-2">
                                                        <span>ğŸ”—</span> ì»¬ë ‰ì…˜ ê³µìœ í•˜ê¸°
                                                    </button>
                                                </div>
                                            )}
                                            {profileTab === 'worldcup' ? (
                                                <div className="space-y-4 pb-10">
                                                    {worldcupHistory.length === 0 ? (
                                                        <div className="py-20 text-center text-gray-300 font-bold">{t.no_data}</div>
                                                    ) : (
                                                        worldcupHistory.map((record, idx) => {
                                                            const rawData = window.WEBTOON_DATA || MOCK_WEBTOONS;
                                                            const w = rawData.find(it => (it.titleId || it.id) == record.winner_id);
                                                            return (
                                                                <div key={idx} className="flex gap-4 p-4 rounded-[28px] border border-yellow-100 bg-yellow-50/30 hover:bg-yellow-50 transition-all">
                                                                    {w && (
                                                                        <>
                                                                            <div className="w-16 h-20 rounded-xl overflow-hidden flex-shrink-0 bg-gray-100">
                                                                                <img src={w.thumbnailUrl || w.thumbnail} referrerPolicy="no-referrer" className="w-full h-full object-cover" />
                                                                            </div>
                                                                            <div className="flex flex-col justify-center min-w-0 flex-grow">
                                                                                <h4 className="font-extrabold text-gray-900 text-sm truncate tracking-tight">{record.winner_title}</h4>
                                                                                <p className="text-[10px] font-bold text-yellow-600 uppercase mt-1">ğŸ† {record.round}{t.worldcup_round} {t.worldcup_winner}</p>
                                                                                <p className="text-[9px] text-gray-400 mt-1">{new Date(record.created_at).toLocaleDateString()}</p>
                                                                            </div>
                                                                        </>
                                                                    )}
                                                                </div>
                                                            );
                                                        })
                                                    )}
                                                </div>
                                            ) : (
                                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 pb-10">
                                                    {(profileTab === 'liked' ? likedIds : dislikedIds).length === 0 ? (
                                                        <div className="col-span-full py-20 text-center text-gray-300 font-bold">{t.no_data}</div>
                                                    ) : (
                                                        (profileTab === 'liked' ? likedIds : dislikedIds).map(id => {
                                                            const rawData = window.WEBTOON_DATA || MOCK_WEBTOONS;
                                                            const w = rawData.find(it => (it.titleId || it.id) == id);
                                                            if (!w) return null;
                                                            const isExcludedFromReco = excludedFromRecoIds.includes(id);
                                                            return (
                                                                <div key={id} className="flex flex-col gap-3 p-4 rounded-[28px] border border-gray-50 bg-gray-50/50 hover:bg-white hover:shadow-soft transition-all group">
                                                                    <div className="flex gap-4">
                                                                        <div className="w-16 h-20 rounded-xl overflow-hidden flex-shrink-0 bg-gray-100">
                                                                            <img src={w.thumbnailUrl || w.thumbnail} referrerPolicy="no-referrer" className="w-full h-full object-cover" />
                                                                        </div>
                                                                        <div className="flex flex-col justify-center min-w-0 flex-grow">
                                                                            <h4 className="font-extrabold text-gray-900 text-sm truncate tracking-tight">{w.titleName || w.title}</h4>
                                                                            <p className="text-[10px] font-bold text-gray-400 uppercase mt-1">{(w.tags || []).slice(0, 2).join(' ')}</p>
                                                                        </div>
                                                                        <button
                                                                            onClick={async () => {
                                                                                if (profileTab === 'liked') {
                                                                                    await supabaseClient.from('favorite_webtoons').delete().eq('user_id', user.id).eq('webtoon_id', id);
                                                                                    setLikedIds(prev => prev.filter(it => it !== id));
                                                                                } else {
                                                                                    await supabaseClient.from('excluded_webtoons').delete().eq('user_id', user.id).eq('webtoon_id', id);
                                                                                    setDislikedIds(prev => prev.filter(it => it !== id));
                                                                                }
                                                                            }}
                                                                            className="flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full bg-white text-gray-300 hover:text-red-500 shadow-sm transition-all"
                                                                        >
                                                                            <svg viewBox="0 0 24 24" className="w-4 h-4 fill-current"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
                                                                        </button>
                                                                    </div>
                                                                    <div className="flex items-center justify-between px-2 pt-2 border-t border-gray-100">
                                                                        <label className="flex items-center gap-2 cursor-pointer group/toggle">
                                                                            <input
                                                                                type="checkbox"
                                                                                checked={isExcludedFromReco}
                                                                                onChange={async (e) => {
                                                                                    const checked = e.target.checked;
                                                                                    if (checked) {
                                                                                        await supabaseClient.from('excluded_from_recommendations').insert({ user_id: user.id, webtoon_id: id });
                                                                                        setExcludedFromRecoIds(prev => [...prev, id]);
                                                                                    } else {
                                                                                        await supabaseClient.from('excluded_from_recommendations').delete().eq('user_id', user.id).eq('webtoon_id', id);
                                                                                        setExcludedFromRecoIds(prev => prev.filter(it => it !== id));
                                                                                    }
                                                                                }}
                                                                                className="w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"
                                                                            />
                                                                            <span className="text-[10px] font-bold text-gray-500 group-hover/toggle:text-gray-700">{t.exclude_from_reco}</span>
                                                                        </label>
                                                                        <span className="text-[9px] text-gray-400">{t.exclude_from_reco_desc}</span>
                                                                    </div>
                                                                </div>
                                                            );
                                                        })
                                                    )}
                                                </div>
                                            )}
                                        </div>
                                        <div className="p-10 pt-6 border-t border-gray-50 flex flex-col gap-4 flex-shrink-0">
                                            <button
                                                onClick={async () => {
                                                    if (confirm(t.delete_confirm)) {
                                                        await supabaseClient.from('favorite_webtoons').delete().eq('user_id', user.id);
                                                        await supabaseClient.from('excluded_webtoons').delete().eq('user_id', user.id);
                                                        await supabaseClient.auth.signOut();
                                                        alert("All data cleared. Your account is now inactive.");
                                                        setShowProfileModal(false);
                                                    }
                                                }}
                                                className="text-[11px] font-bold text-gray-300 hover:text-red-400 transition-colors self-center uppercase border-b border-gray-100"
                                            >
                                                {t.delete_account}
                                            </button>
                                            <button onClick={() => setShowProfileModal(false)} className="w-full py-5 bg-gray-50 rounded-2xl text-gray-400 font-black uppercase">CLOSE</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )
                    }

                    {/* Footer with Visitor Counter */}
                    <footer className="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-md border-t border-gray-100 py-3 px-4 z-[900]">
                        <div className="max-w-7xl mx-auto flex items-center justify-center gap-6">
                            <div className="flex items-center gap-2">
                                <span className="text-[10px] font-bold text-gray-400 uppercase tracking-wide">{t.today_visitors}</span>
                                <span className="text-sm font-black text-primary">{todayVisitors.toLocaleString()}</span>
                            </div>
                            <div className="w-px h-4 bg-gray-200"></div>
                            <div className="flex items-center gap-2">
                                <span className="text-[10px] font-bold text-gray-400 uppercase tracking-wide">{t.total_visitors}</span>
                                <span className="text-sm font-black text-gray-600">{totalVisitors.toLocaleString()}</span>
                            </div>
                        </div>
                    </footer>
                </div >
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>

</html>